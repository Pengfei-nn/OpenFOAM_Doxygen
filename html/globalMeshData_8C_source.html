<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>OpenFOAM: src/OpenFOAM/meshes/polyMesh/globalMeshData/globalMeshData.C Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="OpenFOAMlogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"><a href="http://openfoam.com">OpenFOAM</a>
   &#160;<span id="projectnumber"><a href="http://openfoam.com/download/source">v1912</a></span>
   </div>
   <div id="projectbrief"><a href="https://develop.openfoam.com">The open source CFD toolbox</a></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_c5473ff19b20e6ec4dfe5c310b3778a8.html">OpenFOAM</a></li><li class="navelem"><a class="el" href="dir_aa2423979fb45fc41c393a5db370ab21.html">meshes</a></li><li class="navelem"><a class="el" href="dir_5e5a63cb97aae3d01c8e98f0c14953bc.html">polyMesh</a></li><li class="navelem"><a class="el" href="dir_95ca72a671ba08a3e33cea2e49f9882b.html">globalMeshData</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">globalMeshData.C</div>  </div>
</div><!--header-->
<div class="contents">
<a href="globalMeshData_8C.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*---------------------------------------------------------------------------*\</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">  =========                 |</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">  \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">   \\    /   O peration     |</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">    \\  /    A nd           | www.openfoam.com</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">     \\/     M anipulation  |</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">-------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">    Copyright (C) 2011-2017 OpenFOAM Foundation</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">    Copyright (C) 2015-2019 OpenCFD Ltd.</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">-------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">License</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">    This file is part of OpenFOAM.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">    OpenFOAM is free software: you can redistribute it and/or modify it</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">    under the terms of the GNU General Public License as published by</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">    the Free Software Foundation, either version 3 of the License, or</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">    (at your option) any later version.</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">    OpenFOAM is distributed in the hope that it will be useful, but WITHOUT</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">    ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">    FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">    for more details.</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">    You should have received a copy of the GNU General Public License</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">    along with OpenFOAM.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">\*---------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="globalMeshData_8H.html">globalMeshData.H</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Pstream_8H.html">Pstream.H</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PstreamCombineReduceOps_8H.html">PstreamCombineReduceOps.H</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="processorPolyPatch_8H.html">processorPolyPatch.H</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="globalPoints_8H.html">globalPoints.H</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="polyMesh_8H.html">polyMesh.H</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mapDistribute_8H.html">mapDistribute.H</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="labelIOList_8H.html">labelIOList.H</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mergePoints_8H.html">mergePoints.H</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="globalIndexAndTransform_8H.html">globalIndexAndTransform.H</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">// * * * * * * * * * * * * * * Static Data Members * * * * * * * * * * * * * //</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="keyword">namespace </span>Foam</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;{</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<a class="code" href="namespaceFoam.html#a9907f9d4272b10c75ac87c1679b77c24">defineTypeNameAndDebug</a>(globalMeshData, 0);</div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="classFoam_1_1minEqOp_3_01labelPair_01_4.html#a131b2d9d4e100f101911f04944600277">   45</a></span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keyword">const</span> scalar <a class="code" href="classFoam_1_1globalMeshData.html#a4854ae79c476f0f62c0452c8ba5767ab">globalMeshData::matchTol_</a> = 1<a class="code" href="namespaceFoam_1_1constant_1_1electromagnetic.html#a1885f51cb0544664f4e80e895d163fc8">e</a>-8;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="keyword">template</span>&lt;&gt;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="keyword">class </span><a class="code" href="structFoam_1_1minEqOp.html">minEqOp</a>&lt;<a class="code" href="classFoam_1_1Pair.html">labelPair</a>&gt;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;{</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="structFoam_1_1minEqOp.html#a7a57bfb4b15d7267a89d15acd1e958cd">operator()</a>(<a class="code" href="classFoam_1_1Pair.html">labelPair</a>&amp; <a class="code" href="LISASMDCalcMethod2_8H.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>, <span class="keyword">const</span> <a class="code" href="classFoam_1_1Pair.html">labelPair</a>&amp; <a class="code" href="LISASMDCalcMethod1_8H.html#afa8b67a0d5607da908ad92ed485e19e8">y</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        x[0] = <a class="code" href="namespaceFoam.html#a96b65441175bbfb9a869045dc05fb0b9">min</a>(x[0], y[0]);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        x[1] = <a class="code" href="namespaceFoam.html#a96b65441175bbfb9a869045dc05fb0b9">min</a>(x[1], y[1]);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    }</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;};</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;}</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">// * * * * * * * * * * * * * Private Member Functions  * * * * * * * * * * * //</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="keywordtype">void</span> Foam::globalMeshData::initProcAddr()</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;{</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    processorPatchIndices_.<a class="code" href="classFoam_1_1List.html#a3eb74b6b9f8c1346a09c49e3eade797c">setSize</a>(mesh_.<a class="code" href="classFoam_1_1polyMesh.html#a6b7f5ba89250dbd7a1c6c7860ab60fe3">boundaryMesh</a>().<a class="code" href="classFoam_1_1UPtrList.html#a95603446b248fe1ecf5dc59bcc2eaff0">size</a>());</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    processorPatchIndices_ = -1;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    processorPatchNeighbours_.<a class="code" href="classFoam_1_1List.html#a3eb74b6b9f8c1346a09c49e3eade797c">setSize</a>(mesh_.<a class="code" href="classFoam_1_1polyMesh.html#a6b7f5ba89250dbd7a1c6c7860ab60fe3">boundaryMesh</a>().<a class="code" href="classFoam_1_1UPtrList.html#a95603446b248fe1ecf5dc59bcc2eaff0">size</a>());</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    processorPatchNeighbours_ = -1;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="comment">// Construct processor patch indexing. processorPatchNeighbours_ only</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="comment">// set if running in parallel!</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    processorPatches_.<a class="code" href="classFoam_1_1List.html#a3eb74b6b9f8c1346a09c49e3eade797c">setSize</a>(mesh_.<a class="code" href="classFoam_1_1polyMesh.html#a6b7f5ba89250dbd7a1c6c7860ab60fe3">boundaryMesh</a>().<a class="code" href="classFoam_1_1UPtrList.html#a95603446b248fe1ecf5dc59bcc2eaff0">size</a>());</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> nNeighbours = 0;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(mesh_.<a class="code" href="classFoam_1_1polyMesh.html#a6b7f5ba89250dbd7a1c6c7860ab60fe3">boundaryMesh</a>(), patchi)</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="keywordflow">if</span> (isA&lt;processorPolyPatch&gt;(mesh_.<a class="code" href="classFoam_1_1polyMesh.html#a6b7f5ba89250dbd7a1c6c7860ab60fe3">boundaryMesh</a>()[patchi]))</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            processorPatches_[nNeighbours] = patchi;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            processorPatchIndices_[patchi] = nNeighbours++;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        }</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    }</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    processorPatches_.<a class="code" href="classFoam_1_1List.html#a3eb74b6b9f8c1346a09c49e3eade797c">setSize</a>(nNeighbours);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classFoam_1_1UPstream.html#adbb27f04b5705440fb8b09f278059011">Pstream::parRun</a>())</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        PstreamBuffers pBufs(<a class="code" href="classFoam_1_1UPstream.html#a12cf32e9b7820a2c00bf40c8617ab55ba72e9de442d0453d90fc4586a414ddaf5">Pstream::commsTypes::nonBlocking</a>);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="comment">// Send indices of my processor patches to my neighbours</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> patchi : processorPatches_)</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            UOPstream toNeighbour</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            (</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                refCast&lt;const processorPolyPatch&gt;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                (</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                    mesh_.<a class="code" href="classFoam_1_1polyMesh.html#a6b7f5ba89250dbd7a1c6c7860ab60fe3">boundaryMesh</a>()[patchi]</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                ).neighbProcNo(),</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                pBufs</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            );</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            toNeighbour &lt;&lt; processorPatchIndices_[patchi];</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        pBufs.finishedSends();</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> patchi : processorPatches_)</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            UIPstream fromNeighbour</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            (</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                refCast&lt;const processorPolyPatch&gt;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                (</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                    mesh_.<a class="code" href="classFoam_1_1polyMesh.html#a6b7f5ba89250dbd7a1c6c7860ab60fe3">boundaryMesh</a>()[patchi]</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                ).neighbProcNo(),</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                pBufs</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            );</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            fromNeighbour &gt;&gt; processorPatchNeighbours_[patchi];</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;}</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="keywordtype">void</span> Foam::globalMeshData::calcSharedPoints()<span class="keyword"> const</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordflow">if</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    (</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        nGlobalPoints_ != -1</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;     || sharedPointLabelsPtr_.valid()</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;     || sharedPointAddrPtr_.valid()</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    )</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <a class="code" href="error_8H.html#af2484eff8084de37cba5d9d7a00fb293">FatalErrorInFunction</a></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;Shared point addressing already done&quot;</span> &lt;&lt; <a class="code" href="namespaceFoam.html#a447107a607d03e417307c203fa5fb44b">abort</a>(<a class="code" href="namespaceFoam.html#ac50d206700f3f71855dd30c9a076de43">FatalError</a>);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">// Calculate all shared points (exclude points that are only</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">// on two coupled patches). This does all the hard work.</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    globalPoints parallelPoints(mesh_, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">// Count the number of master points</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> nMaster = 0;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(parallelPoints.pointPoints(), <a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>)</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; pPoints = parallelPoints.pointPoints()[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>];</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; transPPoints =</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            parallelPoints.transformedPointPoints()[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>];</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordflow">if</span> (pPoints.size()+transPPoints.size() &gt; 0)</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        {</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            nMaster++;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">// Allocate global numbers</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    globalIndex masterNumbering(nMaster);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    nGlobalPoints_ = masterNumbering.size();</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="comment">// Push master number to slaves</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">// 1. Fill master and slave slots</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    nMaster = 0;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a> master(parallelPoints.map().constructSize(), -1);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(parallelPoints.pointPoints(), <a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>)</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; pPoints = parallelPoints.pointPoints()[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>];</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; transPPoints =</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            parallelPoints.transformedPointPoints()[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>];</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordflow">if</span> (pPoints.size()+transPPoints.size() &gt; 0)</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            master[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>] = masterNumbering.toGlobal(nMaster);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pPoints, <a class="code" href="shootRays_8H.html#a26c8668e6da16a9f1bf37a8829e5a7db">j</a>)</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                master[pPoints[<a class="code" href="shootRays_8H.html#a26c8668e6da16a9f1bf37a8829e5a7db">j</a>]] = master[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>];</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(transPPoints, <a class="code" href="shootRays_8H.html#a26c8668e6da16a9f1bf37a8829e5a7db">j</a>)</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                master[transPPoints[<a class="code" href="shootRays_8H.html#a26c8668e6da16a9f1bf37a8829e5a7db">j</a>]] = master[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>];</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            nMaster++;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="comment">// 2. Push slave slots back to local storage on originating processor</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">// For all the four types of points:</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">// - local master : already set</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="comment">// - local transformed slave point : the reverse transform at</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="comment">//   reverseDistribute will have copied it back to its originating local</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="comment">//   point</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="comment">// - remote untransformed slave point : sent back to originating processor</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">// - remote transformed slave point : the reverse transform will</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">//   copy it back into the remote slot which then gets sent back to</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">//   originating processor</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    parallelPoints.map().reverseDistribute</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    (</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        parallelPoints.map().constructSize(),</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        master</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    );</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">// Collect all points that are a master or refer to a master.</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    nMaster = 0;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(parallelPoints.pointPoints(), <a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>)</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <span class="keywordflow">if</span> (master[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>] != -1)</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            nMaster++;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        }</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    }</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    sharedPointLabelsPtr_.reset(<span class="keyword">new</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>(nMaster));</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; sharedPointLabels = sharedPointLabelsPtr_();</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    sharedPointAddrPtr_.reset(<span class="keyword">new</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>(nMaster));</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; sharedPointAddr = sharedPointAddrPtr_();</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    nMaster = 0;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(parallelPoints.pointPoints(), <a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>)</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keywordflow">if</span> (master[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>] != -1)</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            <span class="comment">// I am master or slave</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            sharedPointLabels[nMaster] = <a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            sharedPointAddr[nMaster] = master[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>];</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            nMaster++;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceFoam_1_1expressions_1_1patchExpr.html#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>)</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <a class="code" href="namespaceFoam.html#ad20c8f17b81fbe92f6dd235121ca1de9">Pout</a>&lt;&lt; <span class="stringliteral">&quot;globalMeshData : nGlobalPoints_:&quot;</span> &lt;&lt; nGlobalPoints_ &lt;&lt; <a class="code" href="namespaceFoam.html#afbf3861e53bc13fd6c82d9eae8f97378">nl</a></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;globalMeshData : sharedPointLabels_:&quot;</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            &lt;&lt; sharedPointLabelsPtr_().size() &lt;&lt; <a class="code" href="namespaceFoam.html#afbf3861e53bc13fd6c82d9eae8f97378">nl</a></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;globalMeshData : sharedPointAddr_:&quot;</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            &lt;&lt; sharedPointAddrPtr_().size() &lt;&lt; <a class="code" href="namespaceFoam.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;}</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="keywordtype">void</span> Foam::globalMeshData::countSharedEdges</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;(</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keyword">const</span> EdgeMap&lt;labelList&gt;&amp; procSharedEdges,</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    EdgeMap&lt;label&gt;&amp; globalShared,</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>&amp; sharedEdgeI</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;)</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;{</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="comment">// Count occurrences of procSharedEdges in global shared edges table.</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <a class="code" href="stdFoam_8H.html#a93f058f99110e38d0d9d0b2d2b355175">forAllConstIters</a>(procSharedEdges, <a class="code" href="shootRays_8H.html#a1fc3ae6bd5c6a80e9b81b27fc7b7a11a">iter</a>)</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="keyword">const</span> edge&amp; <a class="code" href="namespaceFoam_1_1constant_1_1electromagnetic.html#a1885f51cb0544664f4e80e895d163fc8">e</a> = <a class="code" href="shootRays_8H.html#a1fc3ae6bd5c6a80e9b81b27fc7b7a11a">iter</a>.key();</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="keyword">auto</span> globalFnd = globalShared.find(e);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="keywordflow">if</span> (globalFnd.found())</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            <span class="keywordflow">if</span> (globalFnd() == -1)</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                <span class="comment">// Second time occurence of this edge.</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                <span class="comment">// Assign proper edge label.</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                globalFnd() = sharedEdgeI++;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            <span class="comment">// First time occurrence of this edge. Check how many we are adding.</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="shootRays_8H.html#a1fc3ae6bd5c6a80e9b81b27fc7b7a11a">iter</a>().size() == 1)</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                <span class="comment">// Only one edge. Mark with special value.</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                globalShared.insert(e, -1);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                <span class="comment">// Edge used more than once (even by local shared edges alone)</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                <span class="comment">// so allocate proper shared edge label.</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                globalShared.insert(e, sharedEdgeI++);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            }</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;}</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="keywordtype">void</span> Foam::globalMeshData::calcSharedEdges()<span class="keyword"> const</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">// Shared edges are shared between multiple processors. By their nature both</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">// of their endpoints are shared points. (but not all edges using two shared</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="comment">// points are shared edges! There might e.g. be an edge between two</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">// unrelated clusters of shared points)</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordflow">if</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    (</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        nGlobalEdges_ != -1</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;     || sharedEdgeLabelsPtr_.valid()</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;     || sharedEdgeAddrPtr_.valid()</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    )</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <a class="code" href="error_8H.html#af2484eff8084de37cba5d9d7a00fb293">FatalErrorInFunction</a></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;Shared edge addressing already done&quot;</span> &lt;&lt; <a class="code" href="namespaceFoam.html#a447107a607d03e417307c203fa5fb44b">abort</a>(<a class="code" href="namespaceFoam.html#ac50d206700f3f71855dd30c9a076de43">FatalError</a>);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; sharedPtAddr = sharedPointAddr();</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; sharedPtLabels = sharedPointLabels();</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="comment">// Since don&#39;t want to construct pointEdges for whole mesh create</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="comment">// Map for all shared points.</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    Map&lt;label&gt; meshToShared(2*sharedPtLabels.size());</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(sharedPtLabels, <a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>)</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    {</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        meshToShared.insert(sharedPtLabels[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>], i);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    }</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="comment">// Find edges using shared points. Store correspondence to local edge</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="comment">// numbering. Note that multiple local edges can have the same shared</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="comment">// points! (for cyclics or separated processor patches)</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    EdgeMap&lt;labelList&gt; localShared(2*sharedPtAddr.size());</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#ac74e20afd12e634897e4a0b62666e33b">edgeList</a>&amp; edges = mesh_.edges();</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(edges, edgeI)</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="keyword">const</span> edge&amp; e = edges[edgeI];</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> e0Fnd = meshToShared.cfind(e[0]);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <span class="keywordflow">if</span> (e0Fnd.found())</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            <span class="keyword">const</span> <span class="keyword">auto</span> e1Fnd = meshToShared.cfind(e[1]);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            <span class="keywordflow">if</span> (e1Fnd.found())</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                <span class="comment">// Found edge which uses shared points. Probably shared.</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                <span class="comment">// Construct the edge in shared points (or rather global indices</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                <span class="comment">// of the shared points)</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                edge sharedEdge</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                (</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                    sharedPtAddr[e0Fnd()],</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                    sharedPtAddr[e1Fnd()]</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                );</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                <span class="keyword">auto</span> <a class="code" href="shootRays_8H.html#a1fc3ae6bd5c6a80e9b81b27fc7b7a11a">iter</a> = localShared.find(sharedEdge);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="shootRays_8H.html#a1fc3ae6bd5c6a80e9b81b27fc7b7a11a">iter</a>.found())</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                    <span class="comment">// First occurrence of this point combination. Store.</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                    localShared.insert(sharedEdge, <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>(1, edgeI));</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                }</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                    <span class="comment">// Add this edge to list of edge labels.</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                    <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; edgeLabels = <a class="code" href="shootRays_8H.html#a1fc3ae6bd5c6a80e9b81b27fc7b7a11a">iter</a>();</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                    <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> sz = edgeLabels.size();</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                    edgeLabels.setSize(sz+1);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                    edgeLabels[sz] = edgeI;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                }</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        }</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    }</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="comment">// Now we have a table on every processors which gives its edges which use</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="comment">// shared points. Send this all to the master and have it allocate</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="comment">// global edge numbers for it. But only allocate a global edge number for</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="comment">// edge if it is used more than once!</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="comment">// Note that we are now sending the whole localShared to the master whereas</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="comment">// we only need the local count (i.e. the number of times a global edge is</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="comment">// used). But then this only gets done once so not too bothered about the</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="comment">// extra global communication.</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    EdgeMap&lt;label&gt; globalShared(nGlobalPoints());</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classFoam_1_1UPstream.html#a36af549940a0aae3733774649594489f">Pstream::master</a>())</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> sharedEdgeI = 0;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="comment">// Merge my shared edges into the global list</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespaceFoam_1_1expressions_1_1patchExpr.html#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>)</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            <a class="code" href="namespaceFoam.html#ad20c8f17b81fbe92f6dd235121ca1de9">Pout</a>&lt;&lt; <span class="stringliteral">&quot;globalMeshData::calcSharedEdges : Merging in from proc0 : &quot;</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                &lt;&lt; localShared.size() &lt;&lt; <a class="code" href="namespaceFoam.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        countSharedEdges(localShared, globalShared, sharedEdgeI);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="comment">// Receive data from slaves and insert</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classFoam_1_1UPstream.html#adbb27f04b5705440fb8b09f278059011">Pstream::parRun</a>())</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        {</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            <span class="keywordflow">for</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            (</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                <span class="keywordtype">int</span> slave=<a class="code" href="classFoam_1_1UPstream.html#a83b2c4a5864f50eca8034b84f90e4874">Pstream::firstSlave</a>();</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                slave&lt;=<a class="code" href="classFoam_1_1UPstream.html#a6ba6de79b96f3b7f2d987b2b657f47e1">Pstream::lastSlave</a>();</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                slave++</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            )</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                <span class="comment">// Receive the edges using shared points from the slave.</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                IPstream fromSlave(<a class="code" href="classFoam_1_1UPstream.html#a12cf32e9b7820a2c00bf40c8617ab55ba14343966a1d7dce7526e57cf2206d19d">Pstream::commsTypes::blocking</a>, slave);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                EdgeMap&lt;labelList&gt; procSharedEdges(fromSlave);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespaceFoam_1_1expressions_1_1patchExpr.html#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>)</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                {</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                    <a class="code" href="namespaceFoam.html#ad20c8f17b81fbe92f6dd235121ca1de9">Pout</a>&lt;&lt; <span class="stringliteral">&quot;globalMeshData::calcSharedEdges : &quot;</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;Merging in from proc&quot;</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                        &lt;&lt; <a class="code" href="namespaceFoam.html#a6c8b447ab587a5b141fdabdfac4d4da3">Foam::name</a>(slave) &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; procSharedEdges.size()</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                        &lt;&lt; <a class="code" href="namespaceFoam.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                }</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                countSharedEdges(procSharedEdges, globalShared, sharedEdgeI);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            }</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        }</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        <span class="comment">// Now our globalShared should have some edges with -1 as edge label</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        <span class="comment">// These were only used once so are not proper shared edges.</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <span class="comment">// Remove them.</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        {</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            EdgeMap&lt;label&gt; oldSharedEdges(globalShared);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            globalShared.clear();</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            <a class="code" href="stdFoam_8H.html#a93f058f99110e38d0d9d0b2d2b355175">forAllConstIters</a>(oldSharedEdges, <a class="code" href="shootRays_8H.html#a1fc3ae6bd5c6a80e9b81b27fc7b7a11a">iter</a>)</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            {</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="shootRays_8H.html#a1fc3ae6bd5c6a80e9b81b27fc7b7a11a">iter</a>() != -1)</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                    globalShared.insert(<a class="code" href="shootRays_8H.html#a1fc3ae6bd5c6a80e9b81b27fc7b7a11a">iter</a>.key(), <a class="code" href="shootRays_8H.html#a1fc3ae6bd5c6a80e9b81b27fc7b7a11a">iter</a>());</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                }</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            }</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="namespaceFoam_1_1expressions_1_1patchExpr.html#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>)</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            {</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                <a class="code" href="namespaceFoam.html#ad20c8f17b81fbe92f6dd235121ca1de9">Pout</a>&lt;&lt; <span class="stringliteral">&quot;globalMeshData::calcSharedEdges : Filtered &quot;</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                    &lt;&lt; oldSharedEdges.size()</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot; down to &quot;</span> &lt;&lt; globalShared.size() &lt;&lt; <a class="code" href="namespaceFoam.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        }</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="comment">// Send back to slaves.</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classFoam_1_1UPstream.html#adbb27f04b5705440fb8b09f278059011">Pstream::parRun</a>())</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        {</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            <span class="keywordflow">for</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            (</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                <span class="keywordtype">int</span> slave=<a class="code" href="classFoam_1_1UPstream.html#a83b2c4a5864f50eca8034b84f90e4874">Pstream::firstSlave</a>();</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                slave&lt;=<a class="code" href="classFoam_1_1UPstream.html#a6ba6de79b96f3b7f2d987b2b657f47e1">Pstream::lastSlave</a>();</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                slave++</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            )</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                <span class="comment">// Receive the edges using shared points from the slave.</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                OPstream toSlave(<a class="code" href="classFoam_1_1UPstream.html#a12cf32e9b7820a2c00bf40c8617ab55ba14343966a1d7dce7526e57cf2206d19d">Pstream::commsTypes::blocking</a>, slave);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                toSlave &lt;&lt; globalShared;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        }</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    }</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    {</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <span class="comment">// Send local edges to master</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        {</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            OPstream toMaster</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            (</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                <a class="code" href="classFoam_1_1UPstream.html#a12cf32e9b7820a2c00bf40c8617ab55ba14343966a1d7dce7526e57cf2206d19d">Pstream::commsTypes::blocking</a>,</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                <a class="code" href="classFoam_1_1UPstream.html#a40c4d875df4ff7c32f30f6f596b0f4f8">Pstream::masterNo</a>()</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;            );</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            toMaster &lt;&lt; localShared;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        }</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <span class="comment">// Receive merged edges from master.</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        {</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            IPstream fromMaster</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            (</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                <a class="code" href="classFoam_1_1UPstream.html#a12cf32e9b7820a2c00bf40c8617ab55ba14343966a1d7dce7526e57cf2206d19d">Pstream::commsTypes::blocking</a>,</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                <a class="code" href="classFoam_1_1UPstream.html#a40c4d875df4ff7c32f30f6f596b0f4f8">Pstream::masterNo</a>()</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            );</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            fromMaster &gt;&gt; globalShared;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        }</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    }</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="comment">// Now use the global shared edges list (globalShared) to classify my local</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="comment">// ones (localShared)</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    nGlobalEdges_ = globalShared.size();</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    DynamicList&lt;label&gt; dynSharedEdgeLabels(globalShared.size());</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    DynamicList&lt;label&gt; dynSharedEdgeAddr(globalShared.size());</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <a class="code" href="stdFoam_8H.html#a93f058f99110e38d0d9d0b2d2b355175">forAllConstIters</a>(localShared, <a class="code" href="shootRays_8H.html#a1fc3ae6bd5c6a80e9b81b27fc7b7a11a">iter</a>)</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    {</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        <span class="keyword">const</span> edge&amp; e = <a class="code" href="shootRays_8H.html#a1fc3ae6bd5c6a80e9b81b27fc7b7a11a">iter</a>.key();</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> edgeFnd = globalShared.cfind(e);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <span class="keywordflow">if</span> (edgeFnd.found())</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        {</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;            <span class="comment">// My local edge is indeed a shared one. Go through all local edge</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            <span class="comment">// labels with this point combination.</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; edgeLabels = <a class="code" href="shootRays_8H.html#a1fc3ae6bd5c6a80e9b81b27fc7b7a11a">iter</a>();</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> edgei : edgeLabels)</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                <span class="comment">// Store label of local mesh edge</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                dynSharedEdgeLabels.append(edgei);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                <span class="comment">// Store label of shared edge</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                dynSharedEdgeAddr.append(edgeFnd());</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            }</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        }</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    }</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    sharedEdgeLabelsPtr_.reset(<span class="keyword">new</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>());</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; sharedEdgeLabels = sharedEdgeLabelsPtr_();</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    sharedEdgeLabels.transfer(dynSharedEdgeLabels);</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    sharedEdgeAddrPtr_.reset(<span class="keyword">new</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>());</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; sharedEdgeAddr = sharedEdgeAddrPtr_();</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    sharedEdgeAddr.transfer(dynSharedEdgeAddr);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceFoam_1_1expressions_1_1patchExpr.html#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>)</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    {</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <a class="code" href="namespaceFoam.html#ad20c8f17b81fbe92f6dd235121ca1de9">Pout</a>&lt;&lt; <span class="stringliteral">&quot;globalMeshData : nGlobalEdges_:&quot;</span> &lt;&lt; nGlobalEdges_ &lt;&lt; <a class="code" href="namespaceFoam.html#afbf3861e53bc13fd6c82d9eae8f97378">nl</a></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;globalMeshData : sharedEdgeLabels:&quot;</span> &lt;&lt; sharedEdgeLabels.size()</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            &lt;&lt; <a class="code" href="namespaceFoam.html#afbf3861e53bc13fd6c82d9eae8f97378">nl</a></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;globalMeshData : sharedEdgeAddr:&quot;</span> &lt;&lt; sharedEdgeAddr.size()</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            &lt;&lt; <a class="code" href="namespaceFoam.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    }</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;}</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="keywordtype">void</span> Foam::globalMeshData::calcGlobalPointSlaves()<span class="keyword"> const</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceFoam_1_1expressions_1_1patchExpr.html#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>)</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    {</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        <a class="code" href="namespaceFoam.html#ad20c8f17b81fbe92f6dd235121ca1de9">Pout</a>&lt;&lt; <span class="stringliteral">&quot;globalMeshData::calcGlobalPointSlaves() :&quot;</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; calculating coupled master to slave point addressing.&quot;</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            &lt;&lt; <a class="code" href="namespaceFoam.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    }</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="comment">// Calculate connected points for master points.</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    globalPoints globalData(mesh_, coupledPatch(), <span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    globalPointSlavesPtr_.reset</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    (</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        <span class="keyword">new</span> <a class="code" href="namespaceFoam.html#a8d042301b1c77516c5bfd527662e4f54">labelListList</a></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        (</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;            std::move(globalData.pointPoints())</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        )</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    );</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    globalPointTransformedSlavesPtr_.reset</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    (</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <span class="keyword">new</span> <a class="code" href="namespaceFoam.html#a8d042301b1c77516c5bfd527662e4f54">labelListList</a></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        (</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;            std::move(globalData.transformedPointPoints())</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        )</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    );</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    globalPointSlavesMapPtr_.reset</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    (</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <span class="keyword">new</span> mapDistribute</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        (</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;            std::move(globalData.map())</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        )</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    );</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;}</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="keywordtype">void</span> Foam::globalMeshData::calcPointConnectivity</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;(</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    List&lt;labelPairList&gt;&amp; allPointConnectivity</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;)<span class="keyword"> const</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keyword">const</span> globalIndexAndTransform&amp; transforms = globalTransforms();</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a8d042301b1c77516c5bfd527662e4f54">labelListList</a>&amp; slaves = globalPointSlaves();</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a8d042301b1c77516c5bfd527662e4f54">labelListList</a>&amp; transformedSlaves = globalPointTransformedSlaves();</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="comment">// Create field with my local data</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <a class="code" href="namespaceFoam.html#a112dcff843d9704157222600fe0647c5">labelPairList</a> myData(globalPointSlavesMap().constructSize());</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(slaves, pointi)</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        myData[pointi] = transforms.encode</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        (</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            <a class="code" href="classFoam_1_1UPstream.html#afc74d89573de32a3032c916f8cdd1733">Pstream::myProcNo</a>(),</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            pointi,</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            transforms.nullTransformIndex()</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        );</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    }</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="comment">// Send to master</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    globalPointSlavesMap().distribute(myData);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="comment">// String of connected points with their transform</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    allPointConnectivity.setSize(globalPointSlavesMap().constructSize());</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    allPointConnectivity = <a class="code" href="namespaceFoam.html#a112dcff843d9704157222600fe0647c5">labelPairList</a>(0);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="comment">// Pass1: do the master points since these also update local slaves</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="comment">//        (e.g. from local cyclics)</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(slaves, pointi)</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    {</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <span class="comment">// Reconstruct string of connected points</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; pSlaves = slaves[pointi];</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; pTransformSlaves = transformedSlaves[pointi];</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <span class="keywordflow">if</span> (pSlaves.size()+pTransformSlaves.size())</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        {</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;            <a class="code" href="namespaceFoam.html#a112dcff843d9704157222600fe0647c5">labelPairList</a>&amp; pConnectivity = allPointConnectivity[pointi];</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            pConnectivity.setSize(1+pSlaves.size()+pTransformSlaves.size());</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;            <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> connI = 0;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            <span class="comment">// Add myself</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            pConnectivity[connI++] = myData[pointi];</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;            <span class="comment">// Add untransformed points</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;            <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pSlaves, <a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>)</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;            {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                pConnectivity[connI++] = myData[pSlaves[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>]];</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;            }</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            <span class="comment">// Add transformed points.</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;            <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pTransformSlaves, <a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>)</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;            {</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                <span class="comment">// Get transform from index</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> transformI = globalPointSlavesMap().whichTransform</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                (</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                    pTransformSlaves[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>]</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                );</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                <span class="comment">// Add transform to connectivity</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a0b89283d807abdc103060edb7f371b1f">labelPair</a>&amp; <a class="code" href="TABSMDCalcMethod2_8H.html#a830e93cc5b8d859299d1a788c12be8ac">n</a> = myData[pTransformSlaves[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>]];</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> proci = transforms.processor(n);</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> index = transforms.index(n);</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                pConnectivity[connI++] = transforms.encode</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                (</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                    proci,</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                    index,</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                    transformI</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                );</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            }</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            <span class="comment">// Put back in slots</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;            <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pSlaves, i)</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            {</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                allPointConnectivity[pSlaves[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>]] = pConnectivity;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;            }</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pTransformSlaves, i)</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;            {</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                allPointConnectivity[pTransformSlaves[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>]] = pConnectivity;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;            }</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        }</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    }</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="comment">// Pass2: see if anything is still unset (should not be the case)</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(slaves, pointi)</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    {</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        <a class="code" href="namespaceFoam.html#a112dcff843d9704157222600fe0647c5">labelPairList</a>&amp; pConnectivity = allPointConnectivity[pointi];</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        <span class="keywordflow">if</span> (pConnectivity.size() == 0)</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        {</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            pConnectivity.setSize(1, myData[pointi]);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        }</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    }</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    globalPointSlavesMap().reverseDistribute</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    (</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        slaves.size(),</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        allPointConnectivity</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    );</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;}</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="keywordtype">void</span> Foam::globalMeshData::calcGlobalPointEdges</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;(</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <a class="code" href="namespaceFoam.html#a8d042301b1c77516c5bfd527662e4f54">labelListList</a>&amp; globalPointEdges,</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    List&lt;labelPairList&gt;&amp; globalPointPoints</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;)<span class="keyword"> const</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#ac74e20afd12e634897e4a0b62666e33b">edgeList</a>&amp; edges = coupledPatch().edges();</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a8d042301b1c77516c5bfd527662e4f54">labelListList</a>&amp; pointEdges = coupledPatch().pointEdges();</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="keyword">const</span> globalIndex&amp; globalEdgeNumbers = globalEdgeNumbering();</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a8d042301b1c77516c5bfd527662e4f54">labelListList</a>&amp; slaves = globalPointSlaves();</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a8d042301b1c77516c5bfd527662e4f54">labelListList</a>&amp; transformedSlaves = globalPointTransformedSlaves();</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="keyword">const</span> globalIndexAndTransform&amp; transforms = globalTransforms();</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="comment">// Create local version</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    globalPointEdges.setSize(globalPointSlavesMap().constructSize());</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    globalPointPoints.setSize(globalPointSlavesMap().constructSize());</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pointEdges, pointi)</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    {</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; pEdges = pointEdges[pointi];</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        globalPointEdges[pointi] = globalEdgeNumbers.toGlobal(pEdges);</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        <a class="code" href="namespaceFoam.html#a112dcff843d9704157222600fe0647c5">labelPairList</a>&amp; globalPPoints = globalPointPoints[pointi];</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        globalPPoints.setSize(pEdges.size());</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pEdges, i)</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        {</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;            <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> otherPointi = edges[pEdges[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>]].otherVertex(pointi);</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            globalPPoints[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>] = transforms.encode</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            (</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                <a class="code" href="classFoam_1_1UPstream.html#afc74d89573de32a3032c916f8cdd1733">Pstream::myProcNo</a>(),</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                otherPointi,</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                transforms.nullTransformIndex()</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;            );</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        }</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    }</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="comment">// Pull slave data to master. Dummy transform.</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    globalPointSlavesMap().distribute(globalPointEdges);</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    globalPointSlavesMap().distribute(globalPointPoints);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="comment">// Add all pointEdges</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(slaves, pointi)</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    {</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; pSlaves = slaves[pointi];</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; pTransformSlaves = transformedSlaves[pointi];</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> n = 0;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pSlaves, i)</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        {</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;            n += globalPointEdges[pSlaves[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>]].size();</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        }</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pTransformSlaves, i)</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        {</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;            n += globalPointEdges[pTransformSlaves[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>]].size();</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        }</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        <span class="comment">// Add all the point edges of the slaves to those of the (master) point</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        {</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;            <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; globalPEdges = globalPointEdges[pointi];</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> sz = globalPEdges.size();</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;            globalPEdges.setSize(sz+n);</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;            <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pSlaves, i)</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;            {</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; otherData = globalPointEdges[pSlaves[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>]];</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(otherData, <a class="code" href="shootRays_8H.html#a26c8668e6da16a9f1bf37a8829e5a7db">j</a>)</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                {</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                    globalPEdges[sz++] = otherData[<a class="code" href="shootRays_8H.html#a26c8668e6da16a9f1bf37a8829e5a7db">j</a>];</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                }</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;            }</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;            <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pTransformSlaves, i)</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            {</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; otherData =</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                    globalPointEdges[pTransformSlaves[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>]];</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(otherData, <a class="code" href="shootRays_8H.html#a26c8668e6da16a9f1bf37a8829e5a7db">j</a>)</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                {</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                    globalPEdges[sz++] = otherData[<a class="code" href="shootRays_8H.html#a26c8668e6da16a9f1bf37a8829e5a7db">j</a>];</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                }</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;            }</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            <span class="comment">// Put back in slots</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pSlaves, i)</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            {</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                globalPointEdges[pSlaves[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>]] = globalPEdges;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            }</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;            <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pTransformSlaves, i)</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;            {</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                globalPointEdges[pTransformSlaves[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>]] = globalPEdges;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;            }</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        }</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        <span class="comment">// Same for corresponding pointPoints</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        {</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            <a class="code" href="namespaceFoam.html#a112dcff843d9704157222600fe0647c5">labelPairList</a>&amp; globalPPoints = globalPointPoints[pointi];</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;            <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> sz = globalPPoints.size();</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;            globalPPoints.setSize(sz + n);</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            <span class="comment">// Add untransformed points</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pSlaves, i)</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;            {</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a112dcff843d9704157222600fe0647c5">labelPairList</a>&amp; otherData = globalPointPoints[pSlaves[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>]];</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(otherData, <a class="code" href="shootRays_8H.html#a26c8668e6da16a9f1bf37a8829e5a7db">j</a>)</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                {</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                    globalPPoints[sz++] = otherData[<a class="code" href="shootRays_8H.html#a26c8668e6da16a9f1bf37a8829e5a7db">j</a>];</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                }</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            }</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;            <span class="comment">// Add transformed points.</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;            <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pTransformSlaves, i)</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;            {</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                <span class="comment">// Get transform from index</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> transformI = globalPointSlavesMap().whichTransform</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                (</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                    pTransformSlaves[i]</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                );</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a112dcff843d9704157222600fe0647c5">labelPairList</a>&amp; otherData =</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                    globalPointPoints[pTransformSlaves[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>]];</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(otherData, <a class="code" href="shootRays_8H.html#a26c8668e6da16a9f1bf37a8829e5a7db">j</a>)</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                {</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                    <span class="comment">// Add transform to connectivity</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                    <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a0b89283d807abdc103060edb7f371b1f">labelPair</a>&amp; n = otherData[<a class="code" href="shootRays_8H.html#a26c8668e6da16a9f1bf37a8829e5a7db">j</a>];</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                    <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> proci = transforms.processor(n);</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                    <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> index = transforms.index(n);</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                    globalPPoints[sz++] = transforms.encode</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                    (</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                        proci,</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                        index,</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                        transformI</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                    );</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                }</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;            }</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;            <span class="comment">// Put back in slots</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;            <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pSlaves, i)</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;            {</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                globalPointPoints[pSlaves[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>]] = globalPPoints;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;            }</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;            <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pTransformSlaves, i)</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;            {</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                globalPointPoints[pTransformSlaves[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>]] = globalPPoints;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            }</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        }</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    }</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <span class="comment">// Push back</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    globalPointSlavesMap().reverseDistribute</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    (</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        slaves.size(),</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        globalPointEdges</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    );</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    <span class="comment">// Push back</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    globalPointSlavesMap().reverseDistribute</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    (</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        slaves.size(),</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        globalPointPoints</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    );</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;}</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">Foam::label</a> Foam::globalMeshData::findTransform</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;(</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a112dcff843d9704157222600fe0647c5">labelPairList</a>&amp; info,</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a0b89283d807abdc103060edb7f371b1f">labelPair</a>&amp; remotePoint,</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> localPoint</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;)<span class="keyword"> const</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="keyword">const</span> globalIndexAndTransform&amp; transforms = globalTransforms();</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> remoteProci = transforms.processor(remotePoint);</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> remoteIndex = transforms.index(remotePoint);</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> remoteTransformI = -1;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> localTransformI = -1;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(info, i)</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    {</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> proci = transforms.processor(info[i]);</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> pointi = transforms.index(info[i]);</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> transformI = transforms.transformIndex(info[i]);</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        <span class="keywordflow">if</span> (proci == <a class="code" href="classFoam_1_1UPstream.html#afc74d89573de32a3032c916f8cdd1733">Pstream::myProcNo</a>() &amp;&amp; pointi == localPoint)</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        {</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;            localTransformI = transformI;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            <span class="comment">//Pout&lt;&lt; &quot;For local :&quot; &lt;&lt; localPoint</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            <span class="comment">//    &lt;&lt; &quot; found transform:&quot; &lt;&lt; localTransformI</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            <span class="comment">//    &lt;&lt; endl;</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        }</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        <span class="keywordflow">if</span> (proci == remoteProci &amp;&amp; pointi == remoteIndex)</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        {</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;            remoteTransformI = transformI;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;            <span class="comment">//Pout&lt;&lt; &quot;For remote:&quot; &lt;&lt; remotePoint</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;            <span class="comment">//    &lt;&lt; &quot; found transform:&quot; &lt;&lt; remoteTransformI</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;            <span class="comment">//    &lt;&lt; &quot; at index:&quot; &lt;&lt; i</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;            <span class="comment">//    &lt;&lt; endl;</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        }</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    }</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="keywordflow">if</span> (remoteTransformI == -1 || localTransformI == -1)</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    {</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        <a class="code" href="error_8H.html#af2484eff8084de37cba5d9d7a00fb293">FatalErrorInFunction</a></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;Problem. Cannot find &quot;</span> &lt;&lt; remotePoint</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; or &quot;</span> &lt;&lt; localPoint  &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;            &lt;&lt; coupledPatch().localPoints()[localPoint]</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; in &quot;</span> &lt;&lt; info</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;            &lt;&lt; <a class="code" href="namespaceFoam.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;remoteTransformI:&quot;</span> &lt;&lt; remoteTransformI &lt;&lt; <a class="code" href="namespaceFoam.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;localTransformI:&quot;</span> &lt;&lt; localTransformI</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;            &lt;&lt; <a class="code" href="namespaceFoam.html#a447107a607d03e417307c203fa5fb44b">abort</a>(<a class="code" href="namespaceFoam.html#ac50d206700f3f71855dd30c9a076de43">FatalError</a>);</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    }</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="keywordflow">return</span> transforms.subtractTransformIndex</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    (</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        remoteTransformI,</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        localTransformI</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    );</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;}</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="keywordtype">void</span> Foam::globalMeshData::calcGlobalEdgeSlaves()<span class="keyword"> const</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceFoam_1_1expressions_1_1patchExpr.html#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>)</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    {</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        <a class="code" href="namespaceFoam.html#ad20c8f17b81fbe92f6dd235121ca1de9">Pout</a>&lt;&lt; <span class="stringliteral">&quot;globalMeshData::calcGlobalEdgeSlaves() :&quot;</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; calculating coupled master to slave edge addressing.&quot;</span> &lt;&lt; <a class="code" href="namespaceFoam.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    }</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#ac74e20afd12e634897e4a0b62666e33b">edgeList</a>&amp; edges = coupledPatch().edges();</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="keyword">const</span> globalIndex&amp; globalEdgeNumbers = globalEdgeNumbering();</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="keyword">const</span> globalIndexAndTransform&amp; transforms = globalTransforms();</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="comment">// The whole problem with deducting edge-connectivity from</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="comment">// point-connectivity is that one of the endpoints might be</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <span class="comment">// a local master but the other endpoint might not. So we first</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="comment">// need to make sure that all points know about connectivity and</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    <span class="comment">// the transformations.</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <span class="comment">// 1. collect point connectivity - basically recreating globalPoints output.</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <span class="comment">// All points will now have a string of coupled points. The transforms are</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <span class="comment">// in respect to the master.</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    List&lt;labelPairList&gt; allPointConnectivity;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    calcPointConnectivity(allPointConnectivity);</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="comment">// 2. Get all pointEdges and pointPoints</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="comment">// Coupled point to global coupled edges and corresponding endpoint.</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <a class="code" href="namespaceFoam.html#a8d042301b1c77516c5bfd527662e4f54">labelListList</a> globalPointEdges;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    List&lt;labelPairList&gt; globalPointPoints;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    calcGlobalPointEdges(globalPointEdges, globalPointPoints);</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <span class="comment">// 3. Now all points have</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    <span class="comment">//      - all the connected points with original transform</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="comment">//      - all the connected global edges</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    <span class="comment">// Now all we need to do is go through all the edges and check</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <span class="comment">// both endpoints. If there is a edge between the two which is</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <span class="comment">// produced by transforming both points in the same way it is a shared</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <span class="comment">// edge.</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <span class="comment">// Collect strings of connected edges.</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    List&lt;labelPairList&gt; allEdgeConnectivity(edges.size());</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(edges, edgeI)</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    {</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        <span class="keyword">const</span> edge&amp; e = edges[edgeI];</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; pEdges0 = globalPointEdges[e[0]];</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a112dcff843d9704157222600fe0647c5">labelPairList</a>&amp; pPoints0 = globalPointPoints[e[0]];</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; pEdges1 = globalPointEdges[e[1]];</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a112dcff843d9704157222600fe0647c5">labelPairList</a>&amp; pPoints1 = globalPointPoints[e[1]];</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        <span class="comment">// Most edges will be size 2</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        DynamicList&lt;labelPair&gt; eEdges(2);</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        <span class="comment">// Append myself.</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        eEdges.append</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        (</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;            transforms.encode</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;            (</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                <a class="code" href="classFoam_1_1UPstream.html#afc74d89573de32a3032c916f8cdd1733">Pstream::myProcNo</a>(),</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                edgeI,</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                transforms.nullTransformIndex()</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;            )</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;        );</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pEdges0, i)</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        {</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;            <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pEdges1, <a class="code" href="shootRays_8H.html#a26c8668e6da16a9f1bf37a8829e5a7db">j</a>)</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;            {</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                <span class="keywordflow">if</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                (</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                    pEdges0[i] == pEdges1[<a class="code" href="shootRays_8H.html#a26c8668e6da16a9f1bf37a8829e5a7db">j</a>]</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                 &amp;&amp; pEdges0[i] != globalEdgeNumbers.toGlobal(edgeI)</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                )</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                {</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                    <span class="comment">// Found a shared edge. Now check if the endpoints</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                    <span class="comment">// go through the same transformation.</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                    <span class="comment">// Local: e[0]    remote:pPoints1[j]</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                    <span class="comment">// Local: e[1]    remote:pPoints0[i]</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                    <span class="comment">// Find difference in transforms to go from point on remote</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                    <span class="comment">// edge (pPoints1[j]) to this point.</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                    <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> transform0 = findTransform</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                    (</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                        allPointConnectivity[e[0]],</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                        pPoints1[<a class="code" href="shootRays_8H.html#a26c8668e6da16a9f1bf37a8829e5a7db">j</a>],</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                        e[0]</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                    );</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                    <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> transform1 = findTransform</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                    (</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                        allPointConnectivity[e[1]],</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                        pPoints0[i],</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                        e[1]</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                    );</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                    <span class="keywordflow">if</span> (transform0 == transform1)</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                    {</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                        <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> proci = globalEdgeNumbers.whichProcID(pEdges0[i]);</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;                        eEdges.append</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                        (</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                            transforms.encode</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                            (</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                                proci,</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                                globalEdgeNumbers.toLocal(proci, pEdges0[i]),</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                                transform0</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                            )</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                        );</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                    }</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                }</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;            }</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        }</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        allEdgeConnectivity[edgeI].transfer(eEdges);</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        <a class="code" href="namespaceFoam.html#ac60e8d67e31d7d0aa03e70e9a6dd3217">sort</a></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        (</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;            allEdgeConnectivity[edgeI],</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;            <a class="code" href="namespaceFoam.html#aa94edac9dd43dd3114964d552001710e">globalIndexAndTransform::less</a>(transforms)</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        );</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    }</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    <span class="comment">// We now have - in allEdgeConnectivity - a list of edges which are shared</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <span class="comment">// between multiple processors. Filter into non-transformed and transformed</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    <span class="comment">// connections.</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    globalEdgeSlavesPtr_.reset(<span class="keyword">new</span> <a class="code" href="namespaceFoam.html#a8d042301b1c77516c5bfd527662e4f54">labelListList</a>(edges.size()));</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    <a class="code" href="namespaceFoam.html#a8d042301b1c77516c5bfd527662e4f54">labelListList</a>&amp; globalEdgeSlaves = globalEdgeSlavesPtr_();</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    List&lt;labelPairList&gt; transformedEdges(edges.size());</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(allEdgeConnectivity, edgeI)</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    {</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a112dcff843d9704157222600fe0647c5">labelPairList</a>&amp; edgeInfo = allEdgeConnectivity[edgeI];</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;        <span class="keywordflow">if</span> (edgeInfo.size() &gt;= 2)</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        {</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a0b89283d807abdc103060edb7f371b1f">labelPair</a>&amp; masterInfo = edgeInfo[0];</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;            <span class="comment">// Check if master edge (= first element (since sorted)) is me.</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;            <span class="keywordflow">if</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;            (</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                (</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                    transforms.processor(masterInfo)</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                 == <a class="code" href="classFoam_1_1UPstream.html#afc74d89573de32a3032c916f8cdd1733">Pstream::myProcNo</a>()</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                )</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;             &amp;&amp; (transforms.index(masterInfo) == edgeI)</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;            )</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;            {</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                <span class="comment">// Sort into transformed and untransformed</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; eEdges = globalEdgeSlaves[edgeI];</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                eEdges.<a class="code" href="classFoam_1_1List.html#a3eb74b6b9f8c1346a09c49e3eade797c">setSize</a>(edgeInfo.size()-1);</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                <a class="code" href="namespaceFoam.html#a112dcff843d9704157222600fe0647c5">labelPairList</a>&amp; trafoEEdges = transformedEdges[edgeI];</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                trafoEEdges.setSize(edgeInfo.size()-1);</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> nonTransformI = 0;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> transformI = 0;</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                <span class="keywordflow">for</span> (<a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> i = 1; i &lt; edgeInfo.size(); i++)</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                {</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                    <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a0b89283d807abdc103060edb7f371b1f">labelPair</a>&amp; info = edgeInfo[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>];</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                    <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> proci = transforms.processor(info);</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                    <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> index = transforms.index(info);</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                    <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> <a class="code" href="namespaceFoam.html#a1fc621b18cd1d8a786e42733c2657a1a">transform</a> = transforms.transformIndex</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                    (</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                        info</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                    );</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                    <span class="keywordflow">if</span> (transform == transforms.nullTransformIndex())</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                    {</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                        eEdges[nonTransformI++] = globalEdgeNumbers.toGlobal</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                        (</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                            proci,</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                            index</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                        );</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                    }</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                    {</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;                        trafoEEdges[transformI++] = info;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                    }</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                }</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                eEdges.setSize(nonTransformI);</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                trafoEEdges.setSize(transformI);</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;            }</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        }</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    }</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <span class="comment">// Construct map</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    globalEdgeTransformedSlavesPtr_.<a class="code" href="classFoam_1_1dimensionSet.html#acec8127b4d70f4670e8a518c2ee61615">reset</a>(<span class="keyword">new</span> <a class="code" href="namespaceFoam.html#a8d042301b1c77516c5bfd527662e4f54">labelListList</a>());</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    List&lt;Map&lt;label&gt;&gt; compactMap(<a class="code" href="classFoam_1_1UPstream.html#aada0e04d8127eda8ee95be0772754a4f">Pstream::nProcs</a>());</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    globalEdgeSlavesMapPtr_.reset</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    (</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;        <span class="keyword">new</span> mapDistribute</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        (</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;            globalEdgeNumbers,</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;            globalEdgeSlaves,</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;            transforms,</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;            transformedEdges,</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;            globalEdgeTransformedSlavesPtr_(),</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;            compactMap</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        )</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    );</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceFoam_1_1expressions_1_1patchExpr.html#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>)</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    {</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        <a class="code" href="namespaceFoam.html#ad20c8f17b81fbe92f6dd235121ca1de9">Pout</a>&lt;&lt; <span class="stringliteral">&quot;globalMeshData::calcGlobalEdgeSlaves() :&quot;</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; coupled edges:&quot;</span> &lt;&lt; edges.size()</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; additional coupled edges:&quot;</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;            &lt;&lt; globalEdgeSlavesMapPtr_().constructSize() - edges.size()</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;            &lt;&lt; <a class="code" href="namespaceFoam.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    }</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;}</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="keywordtype">void</span> Foam::globalMeshData::calcGlobalEdgeOrientation()<span class="keyword"> const</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceFoam_1_1expressions_1_1patchExpr.html#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>)</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    {</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;        <a class="code" href="namespaceFoam.html#ad20c8f17b81fbe92f6dd235121ca1de9">Pout</a>&lt;&lt; <span class="stringliteral">&quot;globalMeshData::calcGlobalEdgeOrientation() :&quot;</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; calculating edge orientation w.r.t. master edge.&quot;</span> &lt;&lt; <a class="code" href="namespaceFoam.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    }</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <span class="keyword">const</span> globalIndex&amp; globalPoints = globalPointNumbering();</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="comment">// 1. Determine master point</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a> masterPoint;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    {</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;        <span class="keyword">const</span> mapDistribute&amp; map = globalPointSlavesMap();</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;        masterPoint.setSize(map.constructSize());</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        masterPoint = <a class="code" href="namespaceFoam.html#a700fe3bfa3b7c2f5937307d76372ab4e">labelMax</a>;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> pointi = 0; pointi &lt; coupledPatch().nPoints(); pointi++)</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;        {</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;            masterPoint[pointi] = globalPoints.toGlobal(pointi);</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;        }</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        syncData</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;        (</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;            masterPoint,</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;            globalPointSlaves(),</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;            globalPointTransformedSlaves(),</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;            map,</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;            minEqOp&lt;label&gt;()</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        );</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    }</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    <span class="comment">// Now all points should know who is master by comparing their global</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    <span class="comment">// pointID with the masterPointID. We now can use this information</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    <span class="comment">// to find the orientation of the master edge.</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    {</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        <span class="keyword">const</span> mapDistribute&amp; map = globalEdgeSlavesMap();</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a8d042301b1c77516c5bfd527662e4f54">labelListList</a>&amp; slaves = globalEdgeSlaves();</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a8d042301b1c77516c5bfd527662e4f54">labelListList</a>&amp; transformedSlaves = globalEdgeTransformedSlaves();</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        <span class="comment">// Distribute orientation of master edge (in masterPoint numbering)</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;        <a class="code" href="namespaceFoam.html#a112dcff843d9704157222600fe0647c5">labelPairList</a> masterEdgeVerts(map.constructSize());</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;        masterEdgeVerts = <a class="code" href="namespaceFoam.html#a0b89283d807abdc103060edb7f371b1f">labelPair</a>(<a class="code" href="namespaceFoam.html#a700fe3bfa3b7c2f5937307d76372ab4e">labelMax</a>, <a class="code" href="namespaceFoam.html#a700fe3bfa3b7c2f5937307d76372ab4e">labelMax</a>);</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> edgeI = 0; edgeI &lt; coupledPatch().nEdges(); edgeI++)</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;        {</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;            <span class="keywordflow">if</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;            (</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                (</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                    slaves[edgeI].size()</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                  + transformedSlaves[edgeI].size()</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                )</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;              &gt; 0</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;            )</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;            {</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                <span class="comment">// I am master. Fill in my masterPoint equivalent.</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;                <span class="keyword">const</span> edge&amp; e = coupledPatch().edges()[edgeI];</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                masterEdgeVerts[edgeI] = <a class="code" href="namespaceFoam.html#a0b89283d807abdc103060edb7f371b1f">labelPair</a></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                (</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                    masterPoint[e[0]],</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                    masterPoint[e[1]]</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                );</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;            }</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;        }</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;        syncData</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;        (</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;            masterEdgeVerts,</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;            slaves,</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;            transformedSlaves,</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;            map,</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;            minEqOp&lt;labelPair&gt;()</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;        );</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;        <span class="comment">// Now check my edges on how they relate to the master&#39;s edgeVerts</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;        globalEdgeOrientationPtr_.reset</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;        (</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;            <span class="keyword">new</span> bitSet(coupledPatch().nEdges())</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;        );</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;        bitSet&amp; globalEdgeOrientation = globalEdgeOrientationPtr_();</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(coupledPatch().edges(), edgeI)</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;        {</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;            <span class="comment">// Test that edge is not single edge on cyclic baffle</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;            <span class="keywordflow">if</span> (masterEdgeVerts[edgeI] != <a class="code" href="namespaceFoam.html#a0b89283d807abdc103060edb7f371b1f">labelPair</a>(<a class="code" href="namespaceFoam.html#a700fe3bfa3b7c2f5937307d76372ab4e">labelMax</a>, <a class="code" href="namespaceFoam.html#a700fe3bfa3b7c2f5937307d76372ab4e">labelMax</a>))</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;            {</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                <span class="keyword">const</span> edge&amp; e = coupledPatch().edges()[edgeI];</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a0b89283d807abdc103060edb7f371b1f">labelPair</a> masterE</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                (</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                    masterPoint[e[0]],</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                    masterPoint[e[1]]</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                );</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">int</span> stat = <a class="code" href="classFoam_1_1Pair.html#aa49b2c738e8fa9b70727f3a3efb22908">labelPair::compare</a></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                (</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                    masterE,</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                    masterEdgeVerts[edgeI]</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                );</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                <span class="keywordflow">if</span> (stat == 0)</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                {</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;                    <a class="code" href="error_8H.html#af2484eff8084de37cba5d9d7a00fb293">FatalErrorInFunction</a></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;problem : my edge:&quot;</span> &lt;&lt; e</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot; in master points:&quot;</span> &lt;&lt; masterE</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot; v.s. masterEdgeVerts:&quot;</span> &lt;&lt; masterEdgeVerts[edgeI]</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                        &lt;&lt; <a class="code" href="namespaceFoam.html#a06ca7250d8e89caf05243ec094843642">exit</a>(<a class="code" href="namespaceFoam.html#ac50d206700f3f71855dd30c9a076de43">FatalError</a>);</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                }</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                {</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;                    globalEdgeOrientation.set(edgeI, (stat == 1));</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                }</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;            }</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;            {</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                globalEdgeOrientation.set(edgeI, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;            }</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;        }</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    }</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceFoam_1_1expressions_1_1patchExpr.html#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>)</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    {</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;        <a class="code" href="namespaceFoam.html#ad20c8f17b81fbe92f6dd235121ca1de9">Pout</a>&lt;&lt; <span class="stringliteral">&quot;globalMeshData::calcGlobalEdgeOrientation() :&quot;</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; finished calculating edge orientation.&quot;</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;            &lt;&lt; <a class="code" href="namespaceFoam.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    }</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;}</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;<span class="keywordtype">void</span> Foam::globalMeshData::calcPointBoundaryFaces</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;(</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    <a class="code" href="namespaceFoam.html#a8d042301b1c77516c5bfd527662e4f54">labelListList</a>&amp; pointBoundaryFaces</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;)<span class="keyword"> const</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <span class="keyword">const</span> polyBoundaryMesh&amp; <a class="code" href="namespaceFoam.html#aadf0ae71dff07b55b32f722f83b2621d">bMesh</a> = mesh_.boundaryMesh();</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <span class="keyword">const</span> Map&lt;label&gt;&amp; meshPointMap = coupledPatch().meshPointMap();</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="comment">// 1. Count</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a> nPointFaces(coupledPatch().<a class="code" href="gmvOutputHeader_8H.html#a4e3cff1e2db0a2643803f58beab1a643">nPoints</a>(), <a class="code" href="namespaceFoam.html#ab64e5584854aaf645dab58faf8793d20">Zero</a>);</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> polyPatch&amp; pp : bMesh)</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    {</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;        <span class="keywordflow">if</span> (!pp.coupled())</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        {</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> face&amp; <a class="code" href="readKivaGrid_8H.html#a888be93833ac7a23170555c69c690288">f</a> : pp)</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;            {</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;                <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(<a class="code" href="readKivaGrid_8H.html#a888be93833ac7a23170555c69c690288">f</a>, fp)</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                {</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                    <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="shootRays_8H.html#a1fc3ae6bd5c6a80e9b81b27fc7b7a11a">iter</a> = meshPointMap.cfind(<a class="code" href="readKivaGrid_8H.html#a888be93833ac7a23170555c69c690288">f</a>[fp]);</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="shootRays_8H.html#a1fc3ae6bd5c6a80e9b81b27fc7b7a11a">iter</a>.found())</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;                    {</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;                        nPointFaces[<a class="code" href="shootRays_8H.html#a1fc3ae6bd5c6a80e9b81b27fc7b7a11a">iter</a>.val()]++;</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;                    }</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;                }</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;            }</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;        }</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    }</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    <span class="comment">// 2. Size</span></div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    pointBoundaryFaces.setSize(coupledPatch().<a class="code" href="gmvOutputHeader_8H.html#a4e3cff1e2db0a2643803f58beab1a643">nPoints</a>());</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(nPointFaces, pointi)</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    {</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;        pointBoundaryFaces[pointi].setSize(nPointFaces[pointi]);</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    }</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    nPointFaces = 0;</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    <span class="comment">// 3. Fill</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(bMesh, patchi)</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    {</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;        <span class="keyword">const</span> polyPatch&amp; pp = bMesh[patchi];</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;        <span class="keywordflow">if</span> (!pp.coupled())</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;        {</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;            <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pp, i)</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;            {</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;                <span class="keyword">const</span> face&amp; <a class="code" href="readKivaGrid_8H.html#a888be93833ac7a23170555c69c690288">f</a> = pp[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>];</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(f, fp)</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                {</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                    <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="shootRays_8H.html#a1fc3ae6bd5c6a80e9b81b27fc7b7a11a">iter</a> = meshPointMap.cfind(f[fp]);</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="shootRays_8H.html#a1fc3ae6bd5c6a80e9b81b27fc7b7a11a">iter</a>.found())</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                    {</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                        <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> bFacei =</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;                             pp.start() + i - mesh_.nInternalFaces();</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;                        pointBoundaryFaces[<a class="code" href="shootRays_8H.html#a1fc3ae6bd5c6a80e9b81b27fc7b7a11a">iter</a>()][nPointFaces[<a class="code" href="shootRays_8H.html#a1fc3ae6bd5c6a80e9b81b27fc7b7a11a">iter</a>()]++] =</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;                            bFacei;</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;                    }</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;                }</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;            }</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;        }</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    }</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;}</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;<span class="keywordtype">void</span> Foam::globalMeshData::calcGlobalPointBoundaryFaces()<span class="keyword"> const</span></div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceFoam_1_1expressions_1_1patchExpr.html#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>)</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    {</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;        <a class="code" href="namespaceFoam.html#ad20c8f17b81fbe92f6dd235121ca1de9">Pout</a>&lt;&lt; <span class="stringliteral">&quot;globalMeshData::calcGlobalPointBoundaryFaces() :&quot;</span></div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; calculating coupled point to boundary face addressing.&quot;</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;            &lt;&lt; <a class="code" href="namespaceFoam.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    }</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    <span class="comment">// Construct local point to (uncoupled)boundaryfaces.</span></div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    <a class="code" href="namespaceFoam.html#a8d042301b1c77516c5bfd527662e4f54">labelListList</a> pointBoundaryFaces;</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    calcPointBoundaryFaces(pointBoundaryFaces);</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    <span class="comment">// Global indices for boundary faces</span></div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    globalBoundaryFaceNumberingPtr_.reset</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    (</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;        <span class="keyword">new</span> globalIndex(mesh_.nBoundaryFaces())</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    );</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    globalIndex&amp; globalIndices = globalBoundaryFaceNumberingPtr_();</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <span class="comment">// Convert local boundary faces to global numbering</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    globalPointBoundaryFacesPtr_.reset</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    (</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;        <span class="keyword">new</span> <a class="code" href="namespaceFoam.html#a8d042301b1c77516c5bfd527662e4f54">labelListList</a>(globalPointSlavesMap().constructSize())</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    );</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    <a class="code" href="namespaceFoam.html#a8d042301b1c77516c5bfd527662e4f54">labelListList</a>&amp; globalPointBoundaryFaces = globalPointBoundaryFacesPtr_();</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pointBoundaryFaces, pointi)</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    {</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; bFaces = pointBoundaryFaces[pointi];</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;        <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; globalFaces = globalPointBoundaryFaces[pointi];</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;        globalFaces.<a class="code" href="classFoam_1_1List.html#a3eb74b6b9f8c1346a09c49e3eade797c">setSize</a>(bFaces.size());</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;        <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(bFaces, i)</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;        {</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;            globalFaces[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>] = globalIndices.toGlobal(bFaces[i]);</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;        }</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    }</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    <span class="comment">// Pull slave pointBoundaryFaces to master</span></div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    globalPointSlavesMap().distribute</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    (</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;        globalPointBoundaryFaces,</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;        <span class="keyword">true</span>    <span class="comment">// put data on transformed points into correct slots</span></div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    );</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    <span class="comment">// Merge slave labels into master globalPointBoundaryFaces.</span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    <span class="comment">// Split into untransformed and transformed values.</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a8d042301b1c77516c5bfd527662e4f54">labelListList</a>&amp; pointSlaves = globalPointSlaves();</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a8d042301b1c77516c5bfd527662e4f54">labelListList</a>&amp; pointTransformSlaves =</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;        globalPointTransformedSlaves();</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    <span class="keyword">const</span> globalIndexAndTransform&amp; transforms = globalTransforms();</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    <span class="comment">// Any faces coming in through transformation</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    List&lt;labelPairList&gt; transformedFaces(pointSlaves.size());</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pointSlaves, pointi)</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    {</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; slaves = pointSlaves[pointi];</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; transformedSlaves = pointTransformSlaves[pointi];</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;        <span class="keywordflow">if</span> (slaves.size() &gt; 0)</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;        {</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;            <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; myBFaces = globalPointBoundaryFaces[pointi];</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;            <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> sz = myBFaces.size();</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;            <span class="comment">// Count</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;            <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> n = 0;</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;            <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(slaves, i)</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;            {</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                n += globalPointBoundaryFaces[slaves[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>]].size();</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;            }</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;            <span class="comment">// Fill</span></div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;            myBFaces.setSize(sz+n);</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;            n = sz;</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;            <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(slaves, i)</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;            {</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; slaveBFaces =</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                    globalPointBoundaryFaces[slaves[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>]];</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                <span class="comment">// Add all slaveBFaces. Note that need to check for</span></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                <span class="comment">// uniqueness only in case of cyclics.</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> slave : slaveBFaces)</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                {</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;                    <span class="keywordflow">if</span> (!SubList&lt;label&gt;(myBFaces, sz).<a class="code" href="TABSMDCalcMethod2_8H.html#a7141f237b2648c631ce5b73215683565">found</a>(slave))</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                    {</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;                        myBFaces[n++] = slave;</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;                    }</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;                }</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;            }</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;            myBFaces.<a class="code" href="classFoam_1_1List.html#a3eb74b6b9f8c1346a09c49e3eade797c">setSize</a>(n);</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;        }</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;        <span class="keywordflow">if</span> (transformedSlaves.size() &gt; 0)</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;        {</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; untrafoFaces = globalPointBoundaryFaces[pointi];</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;            <a class="code" href="namespaceFoam.html#a112dcff843d9704157222600fe0647c5">labelPairList</a>&amp; myBFaces = transformedFaces[pointi];</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;            <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> sz = myBFaces.size();</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;            <span class="comment">// Count</span></div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;            <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> n = 0;</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;            <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(transformedSlaves, i)</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;            {</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;                n += globalPointBoundaryFaces[transformedSlaves[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>]].size();</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;            }</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;            <span class="comment">// Fill</span></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;            myBFaces.setSize(sz+n);</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;            n = sz;</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;            <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(transformedSlaves, i)</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;            {</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;                <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> transformI = globalPointSlavesMap().whichTransform</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;                (</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;                    transformedSlaves[i]</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;                );</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;                <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; slaveBFaces =</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;                    globalPointBoundaryFaces[transformedSlaves[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>]];</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> slave : slaveBFaces)</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;                {</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;                    <span class="comment">// Check that same face not already present untransformed</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;                    <span class="keywordflow">if</span> (!untrafoFaces.found(slave))</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;                    {</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;                        <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> proci = globalIndices.whichProcID(slave);</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;                        <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> facei = globalIndices.toLocal(proci, slave);</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;                        myBFaces[n++] = transforms.encode</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;                        (</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;                            proci,</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;                            facei,</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;                            transformI</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;                        );</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;                    }</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;                }</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;            }</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;            myBFaces.setSize(n);</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;        }</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;        <span class="keywordflow">if</span> (slaves.size() + transformedSlaves.size() == 0)</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;        {</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;             globalPointBoundaryFaces[pointi].clear();</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;        }</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    }</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    <span class="comment">// Construct a map to get the face data directly</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    List&lt;Map&lt;label&gt;&gt; compactMap(<a class="code" href="classFoam_1_1UPstream.html#aada0e04d8127eda8ee95be0772754a4f">Pstream::nProcs</a>());</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    globalPointTransformedBoundaryFacesPtr_.reset</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    (</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;        <span class="keyword">new</span> <a class="code" href="namespaceFoam.html#a8d042301b1c77516c5bfd527662e4f54">labelListList</a>(transformedFaces.size())</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    );</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    globalPointBoundaryFacesMapPtr_.reset</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    (</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;        <span class="keyword">new</span> mapDistribute</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;        (</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;            globalIndices,</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;            globalPointBoundaryFaces,</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;            transforms,</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;            transformedFaces,</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;            globalPointTransformedBoundaryFacesPtr_(),</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;            compactMap</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;        )</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    );</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;    globalPointBoundaryFaces.setSize(coupledPatch().<a class="code" href="gmvOutputHeader_8H.html#a4e3cff1e2db0a2643803f58beab1a643">nPoints</a>());</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    globalPointTransformedBoundaryFacesPtr_().setSize(coupledPatch().<a class="code" href="gmvOutputHeader_8H.html#a4e3cff1e2db0a2643803f58beab1a643">nPoints</a>());</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceFoam_1_1expressions_1_1patchExpr.html#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>)</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    {</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;        <a class="code" href="namespaceFoam.html#ad20c8f17b81fbe92f6dd235121ca1de9">Pout</a>&lt;&lt; <span class="stringliteral">&quot;globalMeshData::calcGlobalPointBoundaryFaces() :&quot;</span></div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; coupled points:&quot;</span> &lt;&lt; coupledPatch().nPoints()</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; local boundary faces:&quot;</span> &lt;&lt;  globalIndices.localSize()</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; additional coupled faces:&quot;</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;            &lt;&lt;  globalPointBoundaryFacesMapPtr_().constructSize()</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;              - globalIndices.localSize()</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;            &lt;&lt; <a class="code" href="namespaceFoam.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    }</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;}</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;<span class="keywordtype">void</span> Foam::globalMeshData::calcGlobalPointBoundaryCells()<span class="keyword"> const</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceFoam_1_1expressions_1_1patchExpr.html#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>)</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    {</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;        <a class="code" href="namespaceFoam.html#ad20c8f17b81fbe92f6dd235121ca1de9">Pout</a>&lt;&lt; <span class="stringliteral">&quot;globalMeshData::calcGlobalPointBoundaryCells() :&quot;</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; calculating coupled point to boundary cell addressing.&quot;</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;            &lt;&lt; <a class="code" href="namespaceFoam.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    }</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    <span class="comment">// Create map of boundary cells and point-cell addressing</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;    <span class="comment">// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;    <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> bCelli = 0;</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    Map&lt;label&gt; meshCellMap(4*coupledPatch().<a class="code" href="gmvOutputHeader_8H.html#a4e3cff1e2db0a2643803f58beab1a643">nPoints</a>());</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    DynamicList&lt;label&gt; cellMap(meshCellMap.size());</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    <span class="comment">// Create addressing for point to boundary cells (local)</span></div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;    <a class="code" href="namespaceFoam.html#a8d042301b1c77516c5bfd527662e4f54">labelListList</a> pointBoundaryCells(coupledPatch().<a class="code" href="gmvOutputHeader_8H.html#a4e3cff1e2db0a2643803f58beab1a643">nPoints</a>());</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;    <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(coupledPatch().meshPoints(), pointi)</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    {</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;        <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> meshPointi = coupledPatch().meshPoints()[pointi];</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; pCells = mesh_.pointCells(meshPointi);</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;        <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; <a class="code" href="createBlockMesh_8H.html#abc31dc51aef6737bee199e876a8dffb5">bCells</a> = pointBoundaryCells[pointi];</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;        bCells.setSize(pCells.size());</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;        <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pCells, i)</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;        {</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> celli = pCells[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>];</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;            <span class="keyword">const</span> <span class="keyword">auto</span> fnd = meshCellMap.cfind(celli);</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;            <span class="keywordflow">if</span> (fnd.found())</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;            {</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;                bCells[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>] = fnd();</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;            }</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;            {</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;                meshCellMap.insert(celli, bCelli);</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;                cellMap.append(celli);</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;                bCells[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>] = bCelli;</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;                bCelli++;</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;            }</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;        }</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    }</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;    boundaryCellsPtr_.reset(<span class="keyword">new</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>(std::move(cellMap)));</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; boundaryCells = boundaryCellsPtr_();</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;    <span class="comment">// Convert point-cells to global (boundary)cell numbers</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    <span class="comment">// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;    globalBoundaryCellNumberingPtr_.reset</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;    (</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;        <span class="keyword">new</span> globalIndex(boundaryCells.size())</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;    );</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;    globalIndex&amp; globalIndices = globalBoundaryCellNumberingPtr_();</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    globalPointBoundaryCellsPtr_.reset</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;    (</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;        <span class="keyword">new</span> <a class="code" href="namespaceFoam.html#a8d042301b1c77516c5bfd527662e4f54">labelListList</a>(globalPointSlavesMap().constructSize())</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;    );</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;    <a class="code" href="namespaceFoam.html#a8d042301b1c77516c5bfd527662e4f54">labelListList</a>&amp; globalPointBoundaryCells = globalPointBoundaryCellsPtr_();</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;    <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pointBoundaryCells, pointi)</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;    {</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; pCells = pointBoundaryCells[pointi];</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;        <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; globalCells = globalPointBoundaryCells[pointi];</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;        globalCells.<a class="code" href="classFoam_1_1List.html#a3eb74b6b9f8c1346a09c49e3eade797c">setSize</a>(pCells.size());</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;        <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pCells, i)</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;        {</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;            globalCells[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>] = globalIndices.toGlobal(pCells[i]);</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;        }</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    }</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    <span class="comment">// Pull slave pointBoundaryCells to master</span></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    globalPointSlavesMap().distribute</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    (</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;        globalPointBoundaryCells,</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;        <span class="keyword">true</span>    <span class="comment">// put data on transformed points into correct slots</span></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    );</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    <span class="comment">// Merge slave labels into master globalPointBoundaryCells</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a8d042301b1c77516c5bfd527662e4f54">labelListList</a>&amp; pointSlaves = globalPointSlaves();</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a8d042301b1c77516c5bfd527662e4f54">labelListList</a>&amp; pointTransformSlaves =</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;        globalPointTransformedSlaves();</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    <span class="keyword">const</span> globalIndexAndTransform&amp; transforms = globalTransforms();</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    List&lt;labelPairList&gt; transformedCells(pointSlaves.size());</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;    <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pointSlaves, pointi)</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    {</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; slaves = pointSlaves[pointi];</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; transformedSlaves = pointTransformSlaves[pointi];</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;        <span class="keywordflow">if</span> (slaves.size() &gt; 0)</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;        {</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;            <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; myBCells = globalPointBoundaryCells[pointi];</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;            <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> sz = myBCells.size();</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;            <span class="comment">// Count</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;            <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> n = 0;</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;            <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(slaves, i)</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;            {</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;                n += globalPointBoundaryCells[slaves[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>]].size();</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;            }</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;            <span class="comment">// Fill</span></div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;            myBCells.setSize(sz+n);</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;            n = sz;</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;            <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(slaves, i)</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;            {</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;                <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; slaveBCells =</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;                    globalPointBoundaryCells[slaves[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>]];</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;                <span class="comment">// Add all slaveBCells. Note that need to check for</span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;                <span class="comment">// uniqueness only in case of cyclics.</span></div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> slave : slaveBCells)</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                {</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;                    <span class="keywordflow">if</span> (!SubList&lt;label&gt;(myBCells, sz).<a class="code" href="TABSMDCalcMethod2_8H.html#a7141f237b2648c631ce5b73215683565">found</a>(slave))</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;                    {</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;                        myBCells[n++] = slave;</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;                    }</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;                }</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;            }</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;            myBCells.<a class="code" href="classFoam_1_1List.html#a3eb74b6b9f8c1346a09c49e3eade797c">setSize</a>(n);</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;        }</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;        <span class="keywordflow">if</span> (transformedSlaves.size() &gt; 0)</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;        {</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; untrafoCells = globalPointBoundaryCells[pointi];</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;            <a class="code" href="namespaceFoam.html#a112dcff843d9704157222600fe0647c5">labelPairList</a>&amp; myBCells = transformedCells[pointi];</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;            <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> sz = myBCells.size();</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;            <span class="comment">// Count</span></div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;            <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> n = 0;</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;            <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(transformedSlaves, i)</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;            {</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                n += globalPointBoundaryCells[transformedSlaves[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>]].size();</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;            }</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;            <span class="comment">// Fill</span></div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;            myBCells.setSize(sz+n);</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;            n = sz;</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;            <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(transformedSlaves, i)</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;            {</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;                <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> transformI = globalPointSlavesMap().whichTransform</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;                (</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;                    transformedSlaves[i]</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;                );</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;                <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; slaveBCells =</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;                    globalPointBoundaryCells[transformedSlaves[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>]];</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> slave : slaveBCells)</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;                {</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;                    <span class="comment">// Check that same cell not already present untransformed</span></div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;                    <span class="keywordflow">if</span> (!untrafoCells.found(slave))</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;                    {</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;                        <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> proci = globalIndices.whichProcID(slave);</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;                        <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> celli = globalIndices.toLocal(proci, slave);</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;                        myBCells[n++] = transforms.encode</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;                        (</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;                            proci,</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;                            celli,</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;                            transformI</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;                        );</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;                    }</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;                }</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;            }</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;            myBCells.setSize(n);</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;        }</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;        <span class="keywordflow">if</span> (slaves.size() + transformedSlaves.size() == 0)</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;        {</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;             globalPointBoundaryCells[pointi].clear();</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;        }</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    }</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    <span class="comment">// Construct a map to get the cell data directly</span></div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    List&lt;Map&lt;label&gt;&gt; compactMap(<a class="code" href="classFoam_1_1UPstream.html#aada0e04d8127eda8ee95be0772754a4f">Pstream::nProcs</a>());</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    globalPointTransformedBoundaryCellsPtr_.reset</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    (</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;        <span class="keyword">new</span> <a class="code" href="namespaceFoam.html#a8d042301b1c77516c5bfd527662e4f54">labelListList</a>(transformedCells.size())</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    );</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    globalPointBoundaryCellsMapPtr_.reset</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    (</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;        <span class="keyword">new</span> mapDistribute</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;        (</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;            globalIndices,</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;            globalPointBoundaryCells,</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;            transforms,</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;            transformedCells,</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;            globalPointTransformedBoundaryCellsPtr_(),</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;            compactMap</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;        )</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    );</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    globalPointBoundaryCells.setSize(coupledPatch().<a class="code" href="gmvOutputHeader_8H.html#a4e3cff1e2db0a2643803f58beab1a643">nPoints</a>());</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    globalPointTransformedBoundaryCellsPtr_().setSize(coupledPatch().<a class="code" href="gmvOutputHeader_8H.html#a4e3cff1e2db0a2643803f58beab1a643">nPoints</a>());</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceFoam_1_1expressions_1_1patchExpr.html#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>)</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    {</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;        <a class="code" href="namespaceFoam.html#ad20c8f17b81fbe92f6dd235121ca1de9">Pout</a>&lt;&lt; <span class="stringliteral">&quot;globalMeshData::calcGlobalPointBoundaryCells() :&quot;</span></div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; coupled points:&quot;</span> &lt;&lt; coupledPatch().nPoints()</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; local boundary cells:&quot;</span> &lt;&lt;  globalIndices.localSize()</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; additional coupled cells:&quot;</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;            &lt;&lt;  globalPointBoundaryCellsMapPtr_().constructSize()</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;              - globalIndices.localSize()</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;            &lt;&lt; <a class="code" href="namespaceFoam.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;    }</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;}</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;<span class="keywordtype">void</span> Foam::globalMeshData::calcGlobalCoPointSlaves()<span class="keyword"> const</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceFoam_1_1expressions_1_1patchExpr.html#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>)</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    {</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;        <a class="code" href="namespaceFoam.html#ad20c8f17b81fbe92f6dd235121ca1de9">Pout</a>&lt;&lt; <span class="stringliteral">&quot;globalMeshData::calcGlobalCoPointSlaves() :&quot;</span></div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; calculating coupled master to collocated&quot;</span></div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; slave point addressing.&quot;</span> &lt;&lt; <a class="code" href="namespaceFoam.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    }</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    <span class="comment">// Calculate connected points for master points.</span></div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    globalPoints globalData(mesh_, coupledPatch(), <span class="keyword">true</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    globalCoPointSlavesPtr_.reset</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    (</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;        <span class="keyword">new</span> <a class="code" href="namespaceFoam.html#a8d042301b1c77516c5bfd527662e4f54">labelListList</a></div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;        (</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;            std::move(globalData.pointPoints())</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;        )</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    );</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    globalCoPointSlavesMapPtr_.reset</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    (</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;        <span class="keyword">new</span> mapDistribute</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;        (</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;            std::move(globalData.map())</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;        )</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    );</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceFoam_1_1expressions_1_1patchExpr.html#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>)</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;    {</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;        <a class="code" href="namespaceFoam.html#ad20c8f17b81fbe92f6dd235121ca1de9">Pout</a>&lt;&lt; <span class="stringliteral">&quot;globalMeshData::calcGlobalCoPointSlaves() :&quot;</span></div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; finished calculating coupled master to collocated&quot;</span></div>
<div class="line"><a name="l01749"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#a21b0848f78fd1c00ed1776524e35ba68"> 1749</a></span>&#160;            &lt;&lt; <span class="stringliteral">&quot; slave point addressing.&quot;</span> &lt;&lt; <a class="code" href="namespaceFoam.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    }</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;}</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;<span class="comment">// * * * * * * * * * * * * * * * * Constructors  * * * * * * * * * * * * * * //</span></div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;Foam::globalMeshData::globalMeshData(<span class="keyword">const</span> polyMesh&amp; <a class="code" href="createDynamicFvMesh_8H.html#a4c1de256df6b3d186a85745b3149394a">mesh</a>)</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;:</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    <a class="code" href="namespaceFoam.html#a30cf573386bba5460dafb158b03611b0">processorTopology</a>(mesh.boundaryMesh(), UPstream::worldComm),</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    mesh_(mesh),</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    nTotalPoints_(-1),</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;    nTotalFaces_(-1),</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    nTotalCells_(-1),</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    processorPatches_(0),</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    processorPatchIndices_(0),</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    processorPatchNeighbours_(0),</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    nGlobalPoints_(-1),</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    sharedPointLabelsPtr_(nullptr),</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;    sharedPointAddrPtr_(nullptr),</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    sharedPointGlobalLabelsPtr_(nullptr),</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    nGlobalEdges_(-1),</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;    sharedEdgeLabelsPtr_(nullptr),</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    sharedEdgeAddrPtr_(nullptr)</div>
<div class="line"><a name="l01773"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#aa34d80c5b139b7ee4416a6432c451fac"> 1773</a></span>&#160;{</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    updateMesh();</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;}</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;<span class="comment">// * * * * * * * * * * * * * * * * Destructor  * * * * * * * * * * * * * * * //</span></div>
<div class="line"><a name="l01779"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#af320697688df08f1438d37a86bcaf25d"> 1779</a></span>&#160;</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;<a class="code" href="classFoam_1_1globalMeshData.html#aa34d80c5b139b7ee4416a6432c451fac">Foam::globalMeshData::~globalMeshData</a>()</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;{</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;    clearOut();</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;}</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classFoam_1_1globalMeshData.html#af320697688df08f1438d37a86bcaf25d">Foam::globalMeshData::clearOut</a>()</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;{</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;    <span class="comment">// Point</span></div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;    nGlobalPoints_ = -1;</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    sharedPointLabelsPtr_.clear();</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    sharedPointAddrPtr_.clear();</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    sharedPointGlobalLabelsPtr_.clear();</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;    <span class="comment">// Edge</span></div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    nGlobalEdges_ = -1;</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    sharedEdgeLabelsPtr_.clear();</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    sharedEdgeAddrPtr_.clear();</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    <span class="comment">// Coupled patch</span></div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;    coupledPatchPtr_.clear();</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;    coupledPatchMeshEdgesPtr_.clear();</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;    coupledPatchMeshEdgeMapPtr_.clear();</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;    globalTransformsPtr_.clear();</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;    <span class="comment">// Point</span></div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    globalPointNumberingPtr_.clear();</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    globalPointSlavesPtr_.clear();</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    globalPointTransformedSlavesPtr_.clear();</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;    globalPointSlavesMapPtr_.clear();</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    <span class="comment">// Edge</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;    globalEdgeNumberingPtr_.clear();</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;    globalEdgeSlavesPtr_.clear();</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;    globalEdgeTransformedSlavesPtr_.clear();</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    globalEdgeOrientationPtr_.clear();</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;    globalEdgeSlavesMapPtr_.clear();</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    <span class="comment">// Face</span></div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;    globalBoundaryFaceNumberingPtr_.clear();</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;    globalPointBoundaryFacesPtr_.clear();</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    globalPointTransformedBoundaryFacesPtr_.clear();</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    globalPointBoundaryFacesMapPtr_.clear();</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;    <span class="comment">// Cell</span></div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;    boundaryCellsPtr_.clear();</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;    globalBoundaryCellNumberingPtr_.clear();</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;    globalPointBoundaryCellsPtr_.clear();</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    globalPointTransformedBoundaryCellsPtr_.clear();</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    globalPointBoundaryCellsMapPtr_.clear();</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;    <span class="comment">// Other: collocated points</span></div>
<div class="line"><a name="l01831"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#ad792c3d93b64d7531318acf72417f30c"> 1831</a></span>&#160;    globalCoPointSlavesPtr_.clear();</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;    globalCoPointSlavesMapPtr_.clear();</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;}</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;<span class="comment">// * * * * * * * * * * * * * * * Member Functions  * * * * * * * * * * * * * //</span></div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;<span class="keyword">const</span> <a class="code" href="classFoam_1_1List.html">Foam::labelList</a>&amp; <a class="code" href="classFoam_1_1globalMeshData.html#ad792c3d93b64d7531318acf72417f30c">Foam::globalMeshData::sharedPointGlobalLabels</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;    <span class="keywordflow">if</span> (!sharedPointGlobalLabelsPtr_.valid())</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;    {</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;        sharedPointGlobalLabelsPtr_.reset</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;        (</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;            <span class="keyword">new</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>(sharedPointLabels().size())</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;        );</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;        <a class="code" href="classFoam_1_1List.html">labelList</a>&amp; sharedPointGlobalLabels = sharedPointGlobalLabelsPtr_();</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;        <a class="code" href="classFoam_1_1IOobject.html">IOobject</a> addrHeader</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;        (</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;            <span class="stringliteral">&quot;pointProcAddressing&quot;</span>,</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;            mesh_.facesInstance()/mesh_.meshSubDir,</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;            mesh_,</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;            <a class="code" href="classFoam_1_1IOobject.html#afb15664dd6f862c31c963d58b4205f93a9e7b8f2e0979fecd1bbc84564f3d3891">IOobject::MUST_READ</a></div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;        );</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;        <span class="keywordflow">if</span> (addrHeader.typeHeaderOk&lt;<a class="code" href="classFoam_1_1IOList.html">labelIOList</a>&gt;(<span class="keyword">true</span>))</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;        {</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;            <span class="comment">// There is a pointProcAddressing file so use it to get labels</span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;            <span class="comment">// on the original mesh</span></div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;            <a class="code" href="namespaceFoam.html#ad20c8f17b81fbe92f6dd235121ca1de9">Pout</a>&lt;&lt; <span class="stringliteral">&quot;globalMeshData::sharedPointGlobalLabels : &quot;</span></div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;Reading pointProcAddressing&quot;</span> &lt;&lt; <a class="code" href="namespaceFoam.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;            <a class="code" href="classFoam_1_1IOList.html">labelIOList</a> pointProcAddressing(addrHeader);</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;            <span class="keyword">const</span> <a class="code" href="classFoam_1_1List.html">labelList</a>&amp; <a class="code" href="readKivaGrid_8H.html#a47c56be1ccc31484675aaec19dded580">pointLabels</a> = sharedPointLabels();</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;            <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pointLabels, i)</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;            {</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;                <span class="comment">// Get my mesh point</span></div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;                <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> pointi = pointLabels[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>];</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;                <span class="comment">// Map to mesh point of original mesh</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;                sharedPointGlobalLabels[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>] = pointProcAddressing[pointi];</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;            }</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;        }</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;        {</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;            <a class="code" href="namespaceFoam.html#ad20c8f17b81fbe92f6dd235121ca1de9">Pout</a>&lt;&lt; <span class="stringliteral">&quot;globalMeshData::sharedPointGlobalLabels :&quot;</span></div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; Setting pointProcAddressing to -1&quot;</span> &lt;&lt; <a class="code" href="namespaceFoam.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;            sharedPointGlobalLabels = -1;</div>
<div class="line"><a name="l01882"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#a69b81b4b8c33b94c94440bc3d7dc3e88"> 1882</a></span>&#160;        }</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;    }</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;    <span class="keywordflow">return</span> *sharedPointGlobalLabelsPtr_;</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;}</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;<a class="code" href="classFoam_1_1Field.html">Foam::pointField</a> <a class="code" href="classFoam_1_1globalMeshData.html#a69b81b4b8c33b94c94440bc3d7dc3e88">Foam::globalMeshData::sharedPoints</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;    <span class="comment">// Get all processors to send their shared points to master.</span></div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;    <span class="comment">// (not very efficient)</span></div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;    <a class="code" href="namespaceFoam.html#a5997a67f2e85a15c0e13a1724273aa5f">pointField</a> sharedPoints(nGlobalPoints());</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; pointAddr = sharedPointAddr();</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; <a class="code" href="readKivaGrid_8H.html#a47c56be1ccc31484675aaec19dded580">pointLabels</a> = sharedPointLabels();</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classFoam_1_1UPstream.html#a36af549940a0aae3733774649594489f">Pstream::master</a>())</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    {</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;        <span class="comment">// Master:</span></div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;        <span class="comment">// insert my own data first</span></div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;        <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pointLabels, i)</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;        {</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;            <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> sharedPointi = pointAddr[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>];</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;            sharedPoints[sharedPointi] = mesh_.points()[pointLabels[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>]];</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;        }</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;        <span class="comment">// Receive data from slaves and insert</span></div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;        <span class="keywordflow">for</span></div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;        (</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;            <span class="keywordtype">int</span> slave=<a class="code" href="classFoam_1_1UPstream.html#a83b2c4a5864f50eca8034b84f90e4874">Pstream::firstSlave</a>();</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;            slave&lt;=<a class="code" href="classFoam_1_1UPstream.html#a6ba6de79b96f3b7f2d987b2b657f47e1">Pstream::lastSlave</a>();</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;            slave++</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;        )</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;        {</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;            IPstream fromSlave(<a class="code" href="classFoam_1_1UPstream.html#a12cf32e9b7820a2c00bf40c8617ab55ba14343966a1d7dce7526e57cf2206d19d">Pstream::commsTypes::blocking</a>, slave);</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;            <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a> nbrSharedPointAddr;</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;            <a class="code" href="namespaceFoam.html#a5997a67f2e85a15c0e13a1724273aa5f">pointField</a> nbrSharedPoints;</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;            fromSlave &gt;&gt; nbrSharedPointAddr &gt;&gt; nbrSharedPoints;</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;            <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(nbrSharedPointAddr, i)</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;            {</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;                <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> sharedPointi = nbrSharedPointAddr[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>];</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;                sharedPoints[sharedPointi] = nbrSharedPoints[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>];</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;            }</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;        }</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;        <span class="comment">// Send back</span></div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;        <span class="keywordflow">for</span></div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;        (</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;            <span class="keywordtype">int</span> slave=<a class="code" href="classFoam_1_1UPstream.html#a83b2c4a5864f50eca8034b84f90e4874">Pstream::firstSlave</a>();</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;            slave&lt;=<a class="code" href="classFoam_1_1UPstream.html#a6ba6de79b96f3b7f2d987b2b657f47e1">Pstream::lastSlave</a>();</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;            slave++</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;        )</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;        {</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;            OPstream toSlave</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;            (</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;                <a class="code" href="classFoam_1_1UPstream.html#a12cf32e9b7820a2c00bf40c8617ab55ba14343966a1d7dce7526e57cf2206d19d">Pstream::commsTypes::blocking</a>,</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;                slave,</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;                sharedPoints.size()*<span class="keyword">sizeof</span>(<a class="code" href="namespaceFoam.html#ab64e5584854aaf645dab58faf8793d20">Zero</a>)</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;            );</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;            toSlave &lt;&lt; sharedPoints;</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;        }</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;    }</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;    {</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;        <span class="comment">// Slave:</span></div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;        <span class="comment">// send points</span></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;        {</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;            OPstream toMaster</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;            (</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;                <a class="code" href="classFoam_1_1UPstream.html#a12cf32e9b7820a2c00bf40c8617ab55ba14343966a1d7dce7526e57cf2206d19d">Pstream::commsTypes::blocking</a>,</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;                <a class="code" href="classFoam_1_1UPstream.html#a40c4d875df4ff7c32f30f6f596b0f4f8">Pstream::masterNo</a>()</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;            );</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;            toMaster</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;                &lt;&lt; pointAddr</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;                &lt;&lt; UIndirectList&lt;point&gt;(mesh_.points(), <a class="code" href="readKivaGrid_8H.html#a47c56be1ccc31484675aaec19dded580">pointLabels</a>)();</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;        }</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;        <span class="comment">// Receive sharedPoints</span></div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;        {</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;            IPstream fromMaster</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;            (</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;                <a class="code" href="classFoam_1_1UPstream.html#a12cf32e9b7820a2c00bf40c8617ab55ba14343966a1d7dce7526e57cf2206d19d">Pstream::commsTypes::blocking</a>,</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;                <a class="code" href="classFoam_1_1UPstream.html#a40c4d875df4ff7c32f30f6f596b0f4f8">Pstream::masterNo</a>()</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;            );</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;            fromMaster &gt;&gt; sharedPoints;</div>
<div class="line"><a name="l01971"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#a9514865a59c04a319922b8f49a151ba7"> 1971</a></span>&#160;        }</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;    }</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    <span class="keywordflow">return</span> sharedPoints;</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;}</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;<a class="code" href="classFoam_1_1Field.html">Foam::pointField</a> <a class="code" href="classFoam_1_1globalMeshData.html#a9514865a59c04a319922b8f49a151ba7">Foam::globalMeshData::geometricSharedPoints</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;    <span class="comment">// Get coords of my shared points</span></div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;    <a class="code" href="namespaceFoam.html#a5997a67f2e85a15c0e13a1724273aa5f">pointField</a> sharedPoints(mesh_.points(), sharedPointLabels());</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;    <span class="comment">// Append from all processors</span></div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;    <a class="code" href="namespaceFoam.html#af09dedba9f523ce6a02baaa029393764">combineReduce</a>(sharedPoints, ListPlusEqOp&lt;pointField&gt;());</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;    <span class="comment">// Merge tolerance</span></div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;    scalar tolDim = matchTol_ * mesh_.bounds().mag();</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;    <span class="comment">// And see how many are unique</span></div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;    <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a> pMap;</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;    <a class="code" href="namespaceFoam.html#a5997a67f2e85a15c0e13a1724273aa5f">pointField</a> mergedPoints;</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;    <a class="code" href="namespaceFoam.html#a22201e6ff70f68af9d05a206ac6358b0">Foam::mergePoints</a></div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;    (</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;        sharedPoints,   <span class="comment">// coordinates to merge</span></div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;        tolDim,         <span class="comment">// tolerance</span></div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;        <span class="keyword">false</span>,          <span class="comment">// verbosity</span></div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;        pMap,</div>
<div class="line"><a name="l01999"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#a36192734fad53b19cb1ee41fb3deb998"> 1999</a></span>&#160;        mergedPoints</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;    );</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    <span class="keywordflow">return</span> mergedPoints;</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;}</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;<a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">Foam::label</a> <a class="code" href="classFoam_1_1globalMeshData.html#a36192734fad53b19cb1ee41fb3deb998">Foam::globalMeshData::nGlobalPoints</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;    <span class="keywordflow">if</span> (nGlobalPoints_ == -1)</div>
<div class="line"><a name="l02009"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#af40f098f2f1db79c818d0ba6b7a1fd42"> 2009</a></span>&#160;    {</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;        calcSharedPoints();</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;    }</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;    <span class="keywordflow">return</span> nGlobalPoints_;</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;}</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;<span class="keyword">const</span> <a class="code" href="classFoam_1_1List.html">Foam::labelList</a>&amp; <a class="code" href="classFoam_1_1globalMeshData.html#af40f098f2f1db79c818d0ba6b7a1fd42">Foam::globalMeshData::sharedPointLabels</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;    <span class="keywordflow">if</span> (!sharedPointLabelsPtr_.valid())</div>
<div class="line"><a name="l02019"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#a0bc2673d6545cbfc0c558590a8a0cb8f"> 2019</a></span>&#160;    {</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;        calcSharedPoints();</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;    }</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    <span class="keywordflow">return</span> *sharedPointLabelsPtr_;</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;}</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;<span class="keyword">const</span> <a class="code" href="classFoam_1_1List.html">Foam::labelList</a>&amp; <a class="code" href="classFoam_1_1globalMeshData.html#a0bc2673d6545cbfc0c558590a8a0cb8f">Foam::globalMeshData::sharedPointAddr</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;    <span class="keywordflow">if</span> (!sharedPointAddrPtr_.valid())</div>
<div class="line"><a name="l02029"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#a7009dca4882c48e17550943e7f43005b"> 2029</a></span>&#160;    {</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;        calcSharedPoints();</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;    }</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;    <span class="keywordflow">return</span> *sharedPointAddrPtr_;</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;}</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;<a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">Foam::label</a> <a class="code" href="classFoam_1_1globalMeshData.html#a7009dca4882c48e17550943e7f43005b">Foam::globalMeshData::nGlobalEdges</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;    <span class="keywordflow">if</span> (nGlobalEdges_ == -1)</div>
<div class="line"><a name="l02039"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#ad78653dfabd687626d66d1a1bc336ec7"> 2039</a></span>&#160;    {</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;        calcSharedEdges();</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    }</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;    <span class="keywordflow">return</span> nGlobalEdges_;</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;}</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;<span class="keyword">const</span> <a class="code" href="classFoam_1_1List.html">Foam::labelList</a>&amp; <a class="code" href="classFoam_1_1globalMeshData.html#ad78653dfabd687626d66d1a1bc336ec7">Foam::globalMeshData::sharedEdgeLabels</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;    <span class="keywordflow">if</span> (!sharedEdgeLabelsPtr_.valid())</div>
<div class="line"><a name="l02049"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#a5082336c19e331472eba8bcbcef56d44"> 2049</a></span>&#160;    {</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;        calcSharedEdges();</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;    }</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;    <span class="keywordflow">return</span> *sharedEdgeLabelsPtr_;</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;}</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;<span class="keyword">const</span> <a class="code" href="classFoam_1_1List.html">Foam::labelList</a>&amp; <a class="code" href="classFoam_1_1globalMeshData.html#a5082336c19e331472eba8bcbcef56d44">Foam::globalMeshData::sharedEdgeAddr</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;    <span class="keywordflow">if</span> (!sharedEdgeAddrPtr_.valid())</div>
<div class="line"><a name="l02059"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#afbcae5ee9ab7ebe172d3809f611d745d"> 2059</a></span>&#160;    {</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;        calcSharedEdges();</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;    }</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;    <span class="keywordflow">return</span> *sharedEdgeAddrPtr_;</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;}</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;<span class="keyword">const</span> <a class="code" href="classFoam_1_1PrimitivePatch.html">Foam::indirectPrimitivePatch</a>&amp; <a class="code" href="classFoam_1_1globalMeshData.html#afbcae5ee9ab7ebe172d3809f611d745d">Foam::globalMeshData::coupledPatch</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;    <span class="keywordflow">if</span> (!coupledPatchPtr_.valid())</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;    {</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;        <span class="keyword">const</span> polyBoundaryMesh&amp; bMesh = mesh_.boundaryMesh();</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;        <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> nCoupled = 0;</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;        <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(bMesh, patchi)</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;        {</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;            <span class="keyword">const</span> polyPatch&amp; pp = bMesh[patchi];</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;            <span class="keywordflow">if</span> (pp.coupled())</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;            {</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;                nCoupled += pp.size();</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;            }</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;        }</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;        <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a> coupledFaces(nCoupled);</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;        nCoupled = 0;</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;        <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(bMesh, patchi)</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;        {</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;            <span class="keyword">const</span> polyPatch&amp; pp = bMesh[patchi];</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;            <span class="keywordflow">if</span> (pp.coupled())</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;            {</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;                <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> facei = pp.start();</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;                <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pp, i)</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;                {</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;                    coupledFaces[nCoupled++] = facei++;</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;                }</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;            }</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;        }</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;        coupledPatchPtr_.reset</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;        (</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;            <span class="keyword">new</span> <a class="code" href="namespaceFoam.html#ade12cb9748f8411c22f9725b2cad88e3">indirectPrimitivePatch</a></div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;            (</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;                IndirectList&lt;face&gt;</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;                (</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;                    mesh_.faces(),</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;                    coupledFaces</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;                ),</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;                mesh_.points()</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;            )</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;        );</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespaceFoam_1_1expressions_1_1patchExpr.html#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>)</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;        {</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;            <a class="code" href="namespaceFoam.html#ad20c8f17b81fbe92f6dd235121ca1de9">Pout</a>&lt;&lt; <span class="stringliteral">&quot;globalMeshData::coupledPatch() :&quot;</span></div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; constructed  coupled faces patch:&quot;</span></div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;  faces:&quot;</span> &lt;&lt; coupledPatchPtr_().size()</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;  points:&quot;</span> &lt;&lt; coupledPatchPtr_().nPoints()</div>
<div class="line"><a name="l02120"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#a206c91a48fcb2446ebdd2216f199441f"> 2120</a></span>&#160;                &lt;&lt; <a class="code" href="namespaceFoam.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;        }</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;    }</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;    <span class="keywordflow">return</span> *coupledPatchPtr_;</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;}</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;<span class="keyword">const</span> <a class="code" href="classFoam_1_1List.html">Foam::labelList</a>&amp; <a class="code" href="classFoam_1_1globalMeshData.html#a206c91a48fcb2446ebdd2216f199441f">Foam::globalMeshData::coupledPatchMeshEdges</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;    <span class="keywordflow">if</span> (!coupledPatchMeshEdgesPtr_.valid())</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;    {</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;        coupledPatchMeshEdgesPtr_.reset</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;        (</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;            <span class="keyword">new</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a></div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;            (</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;                coupledPatch().meshEdges</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;                (</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;                    mesh_.edges(),</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;                    mesh_.pointEdges()</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;                )</div>
<div class="line"><a name="l02140"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#a68fe01255a021a4fae072146a6274076"> 2140</a></span>&#160;            )</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;        );</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;    }</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;    <span class="keywordflow">return</span> *coupledPatchMeshEdgesPtr_;</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;}</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;<span class="keyword">const</span> <a class="code" href="classFoam_1_1Map.html">Foam::Map&lt;Foam::label&gt;</a>&amp; <a class="code" href="classFoam_1_1globalMeshData.html#a68fe01255a021a4fae072146a6274076">Foam::globalMeshData::coupledPatchMeshEdgeMap</a>()<span class="keyword"></span></div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;<span class="keyword">const</span></div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;    <span class="keywordflow">if</span> (!coupledPatchMeshEdgeMapPtr_.valid())</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;    {</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; <a class="code" href="namespaceFoam_1_1constant_1_1atomic.html#ad3f3be5d088879a8898b5f0d96e3633c">me</a> = coupledPatchMeshEdges();</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;        coupledPatchMeshEdgeMapPtr_.reset(<span class="keyword">new</span> Map&lt;label&gt;(2*me.size()));</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;        Map&lt;label&gt;&amp; em = coupledPatchMeshEdgeMapPtr_();</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;        <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(me, i)</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;        {</div>
<div class="line"><a name="l02159"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#a76ea4aeaea723e10a265a12de1b4e076"> 2159</a></span>&#160;            em.insert(me[i], i);</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;        }</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;    }</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    <span class="keywordflow">return</span> *coupledPatchMeshEdgeMapPtr_;</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;}</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;<span class="keyword">const</span> <a class="code" href="classFoam_1_1globalIndex.html">Foam::globalIndex</a>&amp; <a class="code" href="classFoam_1_1globalMeshData.html#a76ea4aeaea723e10a265a12de1b4e076">Foam::globalMeshData::globalPointNumbering</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;    <span class="keywordflow">if</span> (!globalPointNumberingPtr_.valid())</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;    {</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;        globalPointNumberingPtr_.<a class="code" href="classFoam_1_1globalIndex.html#a32d192139d7d41bb8c736fc9f7a38929">reset</a></div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;        (</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;            <span class="keyword">new</span> globalIndex(coupledPatch().<a class="code" href="gmvOutputHeader_8H.html#a4e3cff1e2db0a2643803f58beab1a643">nPoints</a>())</div>
<div class="line"><a name="l02173"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#a6c50db3dabc2d62e0af8cce92919e697"> 2173</a></span>&#160;        );</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;    }</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;    <span class="keywordflow">return</span> *globalPointNumberingPtr_;</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;}</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;<span class="keyword">const</span> <a class="code" href="classFoam_1_1globalIndexAndTransform.html">Foam::globalIndexAndTransform</a>&amp;</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;<a class="code" href="classFoam_1_1globalMeshData.html#a6c50db3dabc2d62e0af8cce92919e697">Foam::globalMeshData::globalTransforms</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;    <span class="keywordflow">if</span> (!globalTransformsPtr_.valid())</div>
<div class="line"><a name="l02183"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#a46e0f83a5e64f815d61733c92c275f89"> 2183</a></span>&#160;    {</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;        globalTransformsPtr_.reset(<span class="keyword">new</span> <a class="code" href="classFoam_1_1globalIndexAndTransform.html">globalIndexAndTransform</a>(mesh_));</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;    }</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;    <span class="keywordflow">return</span> *globalTransformsPtr_;</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;}</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;<span class="keyword">const</span> <a class="code" href="classFoam_1_1List.html">Foam::labelListList</a>&amp; <a class="code" href="classFoam_1_1globalMeshData.html#a46e0f83a5e64f815d61733c92c275f89">Foam::globalMeshData::globalPointSlaves</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;    <span class="keywordflow">if</span> (!globalPointSlavesPtr_.valid())</div>
<div class="line"><a name="l02193"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#a3d0705ed797e2121c43c4bdd2d510f44"> 2193</a></span>&#160;    {</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;        calcGlobalPointSlaves();</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;    }</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;    <span class="keywordflow">return</span> *globalPointSlavesPtr_;</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;}</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;<span class="keyword">const</span> <a class="code" href="classFoam_1_1List.html">Foam::labelListList</a>&amp; <a class="code" href="classFoam_1_1globalMeshData.html#a3d0705ed797e2121c43c4bdd2d510f44">Foam::globalMeshData::globalPointTransformedSlaves</a>()<span class="keyword"></span></div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;<span class="keyword">const</span></div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;    <span class="keywordflow">if</span> (!globalPointTransformedSlavesPtr_.valid())</div>
<div class="line"><a name="l02204"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#ac273c239bfa0b6bf0c37ece116ce813e"> 2204</a></span>&#160;    {</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;        calcGlobalPointSlaves();</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;    }</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;    <span class="keywordflow">return</span> *globalPointTransformedSlavesPtr_;</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;}</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;<span class="keyword">const</span> <a class="code" href="classFoam_1_1mapDistribute.html">Foam::mapDistribute</a>&amp; <a class="code" href="classFoam_1_1globalMeshData.html#ac273c239bfa0b6bf0c37ece116ce813e">Foam::globalMeshData::globalPointSlavesMap</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;    <span class="keywordflow">if</span> (!globalPointSlavesMapPtr_.valid())</div>
<div class="line"><a name="l02214"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#a685585d59e2be0b937728ac25e561b93"> 2214</a></span>&#160;    {</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;        calcGlobalPointSlaves();</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;    }</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;    <span class="keywordflow">return</span> *globalPointSlavesMapPtr_;</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;}</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;<span class="keyword">const</span> <a class="code" href="classFoam_1_1globalIndex.html">Foam::globalIndex</a>&amp; <a class="code" href="classFoam_1_1globalMeshData.html#a685585d59e2be0b937728ac25e561b93">Foam::globalMeshData::globalEdgeNumbering</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;    <span class="keywordflow">if</span> (!globalEdgeNumberingPtr_.valid())</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;    {</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;        globalEdgeNumberingPtr_.<a class="code" href="classFoam_1_1globalIndex.html#a32d192139d7d41bb8c736fc9f7a38929">reset</a></div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;        (</div>
<div class="line"><a name="l02227"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#a2fe434058aaa65022a8f6784f9c20cfa"> 2227</a></span>&#160;            <span class="keyword">new</span> <a class="code" href="classFoam_1_1globalIndex.html">globalIndex</a>(coupledPatch().nEdges())</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;        );</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;    }</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;    <span class="keywordflow">return</span> *globalEdgeNumberingPtr_;</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;}</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;<span class="keyword">const</span> <a class="code" href="classFoam_1_1List.html">Foam::labelListList</a>&amp; <a class="code" href="classFoam_1_1globalMeshData.html#a2fe434058aaa65022a8f6784f9c20cfa">Foam::globalMeshData::globalEdgeSlaves</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;    <span class="keywordflow">if</span> (!globalEdgeSlavesPtr_.valid())</div>
<div class="line"><a name="l02237"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#a2c591aed92bccffe0d99b4f1b45a5de0"> 2237</a></span>&#160;    {</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;        calcGlobalEdgeSlaves();</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;    }</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;    <span class="keywordflow">return</span> *globalEdgeSlavesPtr_;</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;}</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;<span class="keyword">const</span> <a class="code" href="classFoam_1_1List.html">Foam::labelListList</a>&amp; <a class="code" href="classFoam_1_1globalMeshData.html#a2c591aed92bccffe0d99b4f1b45a5de0">Foam::globalMeshData::globalEdgeTransformedSlaves</a>()<span class="keyword"></span></div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;<span class="keyword">const</span></div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;    <span class="keywordflow">if</span> (!globalEdgeTransformedSlavesPtr_.valid())</div>
<div class="line"><a name="l02248"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#af4fe16a9cd5d47dc5d68645f7601f6b5"> 2248</a></span>&#160;    {</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;        calcGlobalEdgeSlaves();</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    }</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;    <span class="keywordflow">return</span> *globalEdgeTransformedSlavesPtr_;</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;}</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;<span class="keyword">const</span> <a class="code" href="classFoam_1_1bitSet.html">Foam::bitSet</a>&amp; <a class="code" href="classFoam_1_1globalMeshData.html#af4fe16a9cd5d47dc5d68645f7601f6b5">Foam::globalMeshData::globalEdgeOrientation</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;    <span class="keywordflow">if</span> (!globalEdgeOrientationPtr_.valid())</div>
<div class="line"><a name="l02258"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#a067b1361a138e9d2c68277599f43ebe6"> 2258</a></span>&#160;    {</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;        calcGlobalEdgeOrientation();</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;    }</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;    <span class="keywordflow">return</span> *globalEdgeOrientationPtr_;</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;}</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;<span class="keyword">const</span> <a class="code" href="classFoam_1_1mapDistribute.html">Foam::mapDistribute</a>&amp; <a class="code" href="classFoam_1_1globalMeshData.html#a067b1361a138e9d2c68277599f43ebe6">Foam::globalMeshData::globalEdgeSlavesMap</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;    <span class="keywordflow">if</span> (!globalEdgeSlavesMapPtr_.valid())</div>
<div class="line"><a name="l02268"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#a65cb0910fd37597865619cf548843aa0"> 2268</a></span>&#160;    {</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;        calcGlobalEdgeSlaves();</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;    }</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;    <span class="keywordflow">return</span> *globalEdgeSlavesMapPtr_;</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;}</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;<span class="keyword">const</span> <a class="code" href="classFoam_1_1globalIndex.html">Foam::globalIndex</a>&amp; <a class="code" href="classFoam_1_1globalMeshData.html#a65cb0910fd37597865619cf548843aa0">Foam::globalMeshData::globalBoundaryFaceNumbering</a>()<span class="keyword"></span></div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;<span class="keyword">const</span></div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;    <span class="keywordflow">if</span> (!globalBoundaryFaceNumberingPtr_.valid())</div>
<div class="line"><a name="l02279"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#a312c00277bb50bcf3843c3a08c8642ea"> 2279</a></span>&#160;    {</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;        calcGlobalPointBoundaryFaces();</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;    }</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;    <span class="keywordflow">return</span> *globalBoundaryFaceNumberingPtr_;</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;}</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;<span class="keyword">const</span> <a class="code" href="classFoam_1_1List.html">Foam::labelListList</a>&amp; <a class="code" href="classFoam_1_1globalMeshData.html#a312c00277bb50bcf3843c3a08c8642ea">Foam::globalMeshData::globalPointBoundaryFaces</a>()<span class="keyword"></span></div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;<span class="keyword">const</span></div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;    <span class="keywordflow">if</span> (!globalPointBoundaryFacesPtr_.valid())</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;    {</div>
<div class="line"><a name="l02291"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#ac82996509736db81875d3cecda052a91"> 2291</a></span>&#160;        calcGlobalPointBoundaryFaces();</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;    }</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;    <span class="keywordflow">return</span> *globalPointBoundaryFacesPtr_;</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;}</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;<span class="keyword">const</span> <a class="code" href="classFoam_1_1List.html">Foam::labelListList</a>&amp;</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;<a class="code" href="classFoam_1_1globalMeshData.html#ac82996509736db81875d3cecda052a91">Foam::globalMeshData::globalPointTransformedBoundaryFaces</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;    <span class="keywordflow">if</span> (!globalPointTransformedBoundaryFacesPtr_.valid())</div>
<div class="line"><a name="l02301"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#a2202dd86fabf30f1eab44a33a9c8f56a"> 2301</a></span>&#160;    {</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;        calcGlobalPointBoundaryFaces();</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;    }</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;    <span class="keywordflow">return</span> *globalPointTransformedBoundaryFacesPtr_;</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;}</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;<span class="keyword">const</span> <a class="code" href="classFoam_1_1mapDistribute.html">Foam::mapDistribute</a>&amp; <a class="code" href="classFoam_1_1globalMeshData.html#a2202dd86fabf30f1eab44a33a9c8f56a">Foam::globalMeshData::globalPointBoundaryFacesMap</a>()<span class="keyword"></span></div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;<span class="keyword">const</span></div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;    <span class="keywordflow">if</span> (!globalPointBoundaryFacesMapPtr_.valid())</div>
<div class="line"><a name="l02312"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#abd89d808383f6e1c648e7098db5ac58c"> 2312</a></span>&#160;    {</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;        calcGlobalPointBoundaryFaces();</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;    }</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;    <span class="keywordflow">return</span> *globalPointBoundaryFacesMapPtr_;</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;}</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;<span class="keyword">const</span> <a class="code" href="classFoam_1_1List.html">Foam::labelList</a>&amp; <a class="code" href="classFoam_1_1globalMeshData.html#abd89d808383f6e1c648e7098db5ac58c">Foam::globalMeshData::boundaryCells</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;    <span class="keywordflow">if</span> (!boundaryCellsPtr_.valid())</div>
<div class="line"><a name="l02322"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#afd21aa8d0d3c07d17271c7ae29982692"> 2322</a></span>&#160;    {</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;        calcGlobalPointBoundaryCells();</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;    }</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;    <span class="keywordflow">return</span> *boundaryCellsPtr_;</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;}</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;<span class="keyword">const</span> <a class="code" href="classFoam_1_1globalIndex.html">Foam::globalIndex</a>&amp; <a class="code" href="classFoam_1_1globalMeshData.html#afd21aa8d0d3c07d17271c7ae29982692">Foam::globalMeshData::globalBoundaryCellNumbering</a>()<span class="keyword"></span></div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;<span class="keyword">const</span></div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;    <span class="keywordflow">if</span> (!globalBoundaryCellNumberingPtr_.valid())</div>
<div class="line"><a name="l02333"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#a8282ee27862ac1816cc8f23af2e3a7d1"> 2333</a></span>&#160;    {</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;        calcGlobalPointBoundaryCells();</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;    }</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;    <span class="keywordflow">return</span> *globalBoundaryCellNumberingPtr_;</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;}</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;<span class="keyword">const</span> <a class="code" href="classFoam_1_1List.html">Foam::labelListList</a>&amp; <a class="code" href="classFoam_1_1globalMeshData.html#a8282ee27862ac1816cc8f23af2e3a7d1">Foam::globalMeshData::globalPointBoundaryCells</a>()<span class="keyword"></span></div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;<span class="keyword">const</span></div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;    <span class="keywordflow">if</span> (!globalPointBoundaryCellsPtr_.valid())</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;    {</div>
<div class="line"><a name="l02345"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#adbad6117287bd1af50003e06464c2db6"> 2345</a></span>&#160;        calcGlobalPointBoundaryCells();</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;    }</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;    <span class="keywordflow">return</span> *globalPointBoundaryCellsPtr_;</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;}</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;<span class="keyword">const</span> <a class="code" href="classFoam_1_1List.html">Foam::labelListList</a>&amp;</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;<a class="code" href="classFoam_1_1globalMeshData.html#adbad6117287bd1af50003e06464c2db6">Foam::globalMeshData::globalPointTransformedBoundaryCells</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;    <span class="keywordflow">if</span> (!globalPointTransformedBoundaryCellsPtr_.valid())</div>
<div class="line"><a name="l02355"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#a129f840ab6aec51848f78b9729fe64a9"> 2355</a></span>&#160;    {</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;        calcGlobalPointBoundaryCells();</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;    }</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;    <span class="keywordflow">return</span> *globalPointTransformedBoundaryCellsPtr_;</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;}</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;<span class="keyword">const</span> <a class="code" href="classFoam_1_1mapDistribute.html">Foam::mapDistribute</a>&amp; <a class="code" href="classFoam_1_1globalMeshData.html#a129f840ab6aec51848f78b9729fe64a9">Foam::globalMeshData::globalPointBoundaryCellsMap</a>()<span class="keyword"></span></div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;<span class="keyword">const</span></div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;    <span class="keywordflow">if</span> (!globalPointBoundaryCellsMapPtr_.valid())</div>
<div class="line"><a name="l02366"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#a1fcda682b7be60ff6140dbc752924d7c"> 2366</a></span>&#160;    {</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;        calcGlobalPointBoundaryCells();</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;    }</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;    <span class="keywordflow">return</span> *globalPointBoundaryCellsMapPtr_;</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;}</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;<span class="keyword">const</span> <a class="code" href="classFoam_1_1List.html">Foam::labelListList</a>&amp; <a class="code" href="classFoam_1_1globalMeshData.html#a1fcda682b7be60ff6140dbc752924d7c">Foam::globalMeshData::globalCoPointSlaves</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;    <span class="keywordflow">if</span> (!globalCoPointSlavesPtr_.valid())</div>
<div class="line"><a name="l02376"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#ab52285621ca75e00b03f68a0a65c16bc"> 2376</a></span>&#160;    {</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;        calcGlobalCoPointSlaves();</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;    }</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;    <span class="keywordflow">return</span> *globalCoPointSlavesPtr_;</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;}</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;<span class="keyword">const</span> <a class="code" href="classFoam_1_1mapDistribute.html">Foam::mapDistribute</a>&amp; <a class="code" href="classFoam_1_1globalMeshData.html#ab52285621ca75e00b03f68a0a65c16bc">Foam::globalMeshData::globalCoPointSlavesMap</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;    <span class="keywordflow">if</span> (!globalCoPointSlavesMapPtr_.valid())</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;    {</div>
<div class="line"><a name="l02387"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#a88daf4a4726e5a4a41e77ec8827e8fb2"> 2387</a></span>&#160;        calcGlobalCoPointSlaves();</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;    }</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;    <span class="keywordflow">return</span> *globalCoPointSlavesMapPtr_;</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;}</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;<a class="code" href="classFoam_1_1autoPtr.html">Foam::autoPtr&lt;Foam::globalIndex&gt;</a> <a class="code" href="classFoam_1_1globalMeshData.html#a88daf4a4726e5a4a41e77ec8827e8fb2">Foam::globalMeshData::mergePoints</a></div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;(</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;    <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; pointToGlobal,</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;    <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; uniquePoints</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;)<span class="keyword"> const</span></div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#ade12cb9748f8411c22f9725b2cad88e3">indirectPrimitivePatch</a>&amp; cpp = coupledPatch();</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;    <span class="keyword">const</span> globalIndex&amp; globalCoupledPoints = globalPointNumbering();</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;    <span class="comment">// Use collocated only</span></div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a8d042301b1c77516c5bfd527662e4f54">labelListList</a>&amp; pointSlaves = globalCoPointSlaves();</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;    <span class="keyword">const</span> mapDistribute&amp; pointSlavesMap = globalCoPointSlavesMap();</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;    <span class="comment">// Points are either</span></div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;    <span class="comment">// - master with slaves</span></div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;    <span class="comment">// - slave with a master</span></div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;    <span class="comment">// - other (since e.g. non-collocated cyclics not connected)</span></div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;    <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a> masterGlobalPoint(cpp.nPoints(), -1);</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;    <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(masterGlobalPoint, pointi)</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;    {</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; slavePoints = pointSlaves[pointi];</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;        <span class="keywordflow">if</span> (slavePoints.size() &gt; 0)</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;        {</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;            masterGlobalPoint[pointi] = globalCoupledPoints.toGlobal(pointi);</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;        }</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;    }</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;    <span class="comment">// Sync by taking max</span></div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;    syncData</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;    (</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;        masterGlobalPoint,</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;        pointSlaves,</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;        <a class="code" href="namespaceFoam.html#a8d042301b1c77516c5bfd527662e4f54">labelListList</a>(0),   <span class="comment">// no transforms</span></div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;        pointSlavesMap,</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;        maxEqOp&lt;label&gt;()</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;    );</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;    <span class="comment">// 1. Count number of masters on my processor.</span></div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;    <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> nMaster = 0;</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;    bitSet isMaster(mesh_.nPoints(), <span class="keyword">true</span>);</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;    <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pointSlaves, pointi)</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;    {</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;        <span class="keywordflow">if</span> (masterGlobalPoint[pointi] == -1)</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;        {</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;            <span class="comment">// unconnected point (e.g. from separated cyclic)</span></div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;            nMaster++;</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;        }</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span></div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;        (</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;            masterGlobalPoint[pointi]</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;         == globalCoupledPoints.toGlobal(pointi)</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;        )</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;        {</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;            <span class="comment">// connected master</span></div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;            nMaster++;</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;        }</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;        {</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;            <span class="comment">// connected slave point</span></div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;            isMaster.unset(cpp.meshPoints()[pointi]);</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;        }</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;    }</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;    <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> myUniquePoints = mesh_.nPoints() - cpp.nPoints() + nMaster;</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;    <span class="comment">//Pout&lt;&lt; &quot;Points :&quot; &lt;&lt; nl</span></div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;    <span class="comment">//    &lt;&lt; &quot;    mesh             : &quot; &lt;&lt; mesh_.nPoints() &lt;&lt; nl</span></div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;    <span class="comment">//    &lt;&lt; &quot;    of which coupled : &quot; &lt;&lt; cpp.nPoints() &lt;&lt; nl</span></div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;    <span class="comment">//    &lt;&lt; &quot;    of which master  : &quot; &lt;&lt; nMaster &lt;&lt; nl</span></div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;    <span class="comment">//    &lt;&lt; endl;</span></div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;    <span class="comment">// 2. Create global indexing for unique points.</span></div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;    autoPtr&lt;globalIndex&gt; globalPointsPtr(<span class="keyword">new</span> globalIndex(myUniquePoints));</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;    <span class="comment">// 3. Assign global point numbers. Keep slaves unset.</span></div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;    pointToGlobal.setSize(mesh_.nPoints());</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;    pointToGlobal = -1;</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;    uniquePoints.setSize(myUniquePoints);</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;    nMaster = 0;</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;    <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(isMaster, meshPointi)</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;    {</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;        <span class="keywordflow">if</span> (isMaster[meshPointi])</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;        {</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;            pointToGlobal[meshPointi] = globalPointsPtr().toGlobal(nMaster);</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;            uniquePoints[nMaster] = meshPointi;</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;            nMaster++;</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;        }</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;    }</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;    <span class="comment">// 4. Push global index for coupled points to slaves.</span></div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;    {</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;        <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a> masterToGlobal(pointSlavesMap.constructSize(), -1);</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;        <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pointSlaves, pointi)</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;        {</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; slaves = pointSlaves[pointi];</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;            <span class="keywordflow">if</span> (slaves.size() &gt; 0)</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;            {</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;                <span class="comment">// Duplicate master globalpoint into slave slots</span></div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;                <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> meshPointi = cpp.meshPoints()[pointi];</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;                masterToGlobal[pointi] = pointToGlobal[meshPointi];</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;                <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(slaves, i)</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;                {</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;                    masterToGlobal[slaves[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>]] = masterToGlobal[pointi];</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;                }</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;            }</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;        }</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;        <span class="comment">// Send back</span></div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;        pointSlavesMap.reverseDistribute(cpp.nPoints(), masterToGlobal);</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;        <span class="comment">// On slave copy master index into overal map.</span></div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;        <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pointSlaves, pointi)</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;        {</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;            <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> meshPointi = cpp.meshPoints()[pointi];</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;            <span class="keywordflow">if</span> (!isMaster[meshPointi])</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;            {</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;                pointToGlobal[meshPointi] = masterToGlobal[pointi];</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;            }</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;        }</div>
<div class="line"><a name="l02521"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#a9f8e8fb232691db420bfb2b14b76e6cc"> 2521</a></span>&#160;    }</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;    <span class="keywordflow">return</span> globalPointsPtr;</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;}</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;<a class="code" href="classFoam_1_1autoPtr.html">Foam::autoPtr&lt;Foam::globalIndex&gt;</a> <a class="code" href="classFoam_1_1globalMeshData.html#a88daf4a4726e5a4a41e77ec8827e8fb2">Foam::globalMeshData::mergePoints</a></div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;(</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; meshPoints,</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;    <span class="keyword">const</span> Map&lt;label&gt;&amp; meshPointMap,</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;    <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; pointToGlobal,</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;    <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; uniqueMeshPoints</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;)<span class="keyword"> const</span></div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#ade12cb9748f8411c22f9725b2cad88e3">indirectPrimitivePatch</a>&amp; cpp = coupledPatch();</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a8d042301b1c77516c5bfd527662e4f54">labelListList</a>&amp; pointSlaves = globalCoPointSlaves();</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;    <span class="keyword">const</span> mapDistribute&amp; pointSlavesMap = globalCoPointSlavesMap();</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;    <span class="comment">// The patch points come in two variants:</span></div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;    <span class="comment">// - not on a coupled patch so guaranteed unique</span></div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;    <span class="comment">// - on a coupled patch</span></div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;    <span class="comment">// If the point is on a coupled patch the problem is that the</span></div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;    <span class="comment">// master-slave structure (globalPointSlaves etc.) assigns one of the</span></div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;    <span class="comment">// coupled points to be the master but this master point is not</span></div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;    <span class="comment">// necessarily on the patch itself! (it might just be connected to the</span></div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;    <span class="comment">// patch point via coupled patches).</span></div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;    <span class="comment">// Determine mapping:</span></div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;    <span class="comment">// - from patch point to coupled point (or -1)</span></div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;    <span class="comment">// - from coupled point to global patch point</span></div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;    <span class="comment">// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;    globalIndex globalPPoints(meshPoints.size());</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;    <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a> patchToCoupled(meshPoints.size(), -1);</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;    <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> nCoupled = 0;</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;    <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a> coupledToGlobalPatch(pointSlavesMap.constructSize(), -1);</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;    <span class="comment">// Note: loop over patch since usually smaller</span></div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;    <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(meshPoints, patchPointi)</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;    {</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;        <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> meshPointi = meshPoints[patchPointi];</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="shootRays_8H.html#a1fc3ae6bd5c6a80e9b81b27fc7b7a11a">iter</a> = cpp.meshPointMap().cfind(meshPointi);</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="shootRays_8H.html#a1fc3ae6bd5c6a80e9b81b27fc7b7a11a">iter</a>.found())</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;        {</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;            patchToCoupled[patchPointi] = <a class="code" href="shootRays_8H.html#a1fc3ae6bd5c6a80e9b81b27fc7b7a11a">iter</a>();</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;            coupledToGlobalPatch[<a class="code" href="shootRays_8H.html#a1fc3ae6bd5c6a80e9b81b27fc7b7a11a">iter</a>()] = globalPPoints.toGlobal(patchPointi);</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;            nCoupled++;</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;        }</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;    }</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;    <span class="comment">//Pout&lt;&lt; &quot;Patch:&quot; &lt;&lt; nl</span></div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;    <span class="comment">//    &lt;&lt; &quot;    points:&quot; &lt;&lt; meshPoints.size() &lt;&lt; nl</span></div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;    <span class="comment">//    &lt;&lt; &quot;    of which on coupled patch:&quot; &lt;&lt; nCoupled &lt;&lt; endl;</span></div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;    <span class="comment">// Determine master of connected points</span></div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;    <span class="comment">// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;    <span class="comment">// Problem is that the coupled master might not be on the patch. So</span></div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;    <span class="comment">// work out the best patch-point master from all connected points.</span></div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;    <span class="comment">// - if the coupled master is on the patch it becomes the patch-point master</span></div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;    <span class="comment">// - else the slave with the lowest numbered patch point label</span></div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;    <span class="comment">// Get all data on master</span></div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;    pointSlavesMap.distribute(coupledToGlobalPatch);</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;    <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pointSlaves, coupledPointi)</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;    {</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a>&amp; slaves = pointSlaves[coupledPointi];</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;        <span class="keywordflow">if</span> (slaves.size() &gt; 0)</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;        {</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;            <span class="comment">// I am master. What is the best candidate for patch-point master</span></div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;            <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> masterI = <a class="code" href="namespaceFoam.html#a700fe3bfa3b7c2f5937307d76372ab4e">labelMax</a>;</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;            <span class="keywordflow">if</span> (coupledToGlobalPatch[coupledPointi] != -1)</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;            {</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;                <span class="comment">// I am master and on the coupled patch. Use me.</span></div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;                masterI = coupledToGlobalPatch[coupledPointi];</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;            }</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;            {</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;                <span class="comment">// Get min of slaves as master.</span></div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;                <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(slaves, i)</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;                {</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;                    <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> slavePp = coupledToGlobalPatch[slaves[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>]];</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;                    <span class="keywordflow">if</span> (slavePp != -1 &amp;&amp; slavePp &lt; masterI)</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;                    {</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;                        masterI = slavePp;</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;                    }</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;                }</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;            }</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;            <span class="keywordflow">if</span> (masterI != <a class="code" href="namespaceFoam.html#a700fe3bfa3b7c2f5937307d76372ab4e">labelMax</a>)</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;            {</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;                <span class="comment">// Push back</span></div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;                coupledToGlobalPatch[coupledPointi] = masterI;</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;                <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(slaves, i)</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;                {</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;                    coupledToGlobalPatch[slaves[<a class="code" href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>]] = masterI;</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;                }</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;            }</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;        }</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;    }</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;    pointSlavesMap.reverseDistribute(cpp.nPoints(), coupledToGlobalPatch);</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;    <span class="comment">// Generate compact numbering for master points</span></div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;    <span class="comment">// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;    <span class="comment">// Now coupledToGlobalPatch is the globalIndex of the master point.</span></div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;    <span class="comment">// Now every processor can check whether they hold it and generate a</span></div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;    <span class="comment">// compact numbering.</span></div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;    <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> nMasters = 0;</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;    <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(meshPoints, patchPointi)</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;    {</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;        <span class="keywordflow">if</span> (patchToCoupled[patchPointi] == -1)</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;        {</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;            nMasters++;</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;        }</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;        {</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;            <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> coupledPointi = patchToCoupled[patchPointi];</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;            <span class="keywordflow">if</span></div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;            (</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;                globalPPoints.toGlobal(patchPointi)</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;             == coupledToGlobalPatch[coupledPointi]</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;            )</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;            {</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;                <span class="comment">// I am the master</span></div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;                nMasters++;</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;            }</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;        }</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;    }</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;    autoPtr&lt;globalIndex&gt; globalPointsPtr(<span class="keyword">new</span> globalIndex(nMasters));</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;    <span class="comment">//Pout&lt;&lt; &quot;Patch:&quot; &lt;&lt; nl</span></div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;    <span class="comment">//    &lt;&lt; &quot;    points:&quot; &lt;&lt; meshPoints.size() &lt;&lt; nl</span></div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;    <span class="comment">//    &lt;&lt; &quot;    of which on coupled patch:&quot; &lt;&lt; nCoupled &lt;&lt; nl</span></div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;    <span class="comment">//    &lt;&lt; &quot;    of which master:&quot; &lt;&lt; nMasters &lt;&lt; endl;</span></div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;    <span class="comment">// Push back compact numbering for master point onto slaves</span></div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;    <span class="comment">// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;    pointToGlobal.setSize(meshPoints.size());</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;    pointToGlobal = -1;</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;    uniqueMeshPoints.setSize(nMasters);</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;    <span class="comment">// Sync master in global point numbering so all know the master point.</span></div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;    <span class="comment">// Initialise globalMaster to be -1 except at a globalMaster.</span></div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;    <a class="code" href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">labelList</a> globalMaster(cpp.nPoints(), -1);</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;    nMasters = 0;</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;    <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(meshPoints, patchPointi)</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;    {</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;        <span class="keywordflow">if</span> (patchToCoupled[patchPointi] == -1)</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;        {</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;            uniqueMeshPoints[nMasters++] = meshPoints[patchPointi];</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;        }</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;        {</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;            <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> coupledPointi = patchToCoupled[patchPointi];</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;            <span class="keywordflow">if</span></div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;            (</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;                globalPPoints.toGlobal(patchPointi)</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;             == coupledToGlobalPatch[coupledPointi]</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;            )</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;            {</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;                globalMaster[coupledPointi] =</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;                    globalPointsPtr().toGlobal(nMasters);</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;                uniqueMeshPoints[nMasters++] = meshPoints[patchPointi];</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;            }</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;        }</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;    }</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;    <span class="comment">// Sync by taking max</span></div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;    syncData</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;    (</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;        globalMaster,</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;        pointSlaves,</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;        <a class="code" href="namespaceFoam.html#a8d042301b1c77516c5bfd527662e4f54">labelListList</a>(0),   <span class="comment">// no transforms</span></div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;        pointSlavesMap,</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;        maxEqOp&lt;label&gt;()</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;    );</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;    <span class="comment">// Now everyone has the master point in globalPointsPtr numbering. Fill</span></div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;    <span class="comment">// in the pointToGlobal map.</span></div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;    nMasters = 0;</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;    <a class="code" href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(meshPoints, patchPointi)</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;    {</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;        <span class="keywordflow">if</span> (patchToCoupled[patchPointi] == -1)</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;        {</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;            pointToGlobal[patchPointi] = globalPointsPtr().toGlobal(nMasters++);</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;        }</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;        {</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;            <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> coupledPointi = patchToCoupled[patchPointi];</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;            pointToGlobal[patchPointi] = globalMaster[coupledPointi];</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;            <span class="keywordflow">if</span></div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;            (</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;                globalPPoints.toGlobal(patchPointi)</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;             == coupledToGlobalPatch[coupledPointi]</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;            )</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;            {</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;                nMasters++;</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;            }</div>
<div class="line"><a name="l02735"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#a0ba77b0b036b107db06bafe301c800f1"> 2735</a></span>&#160;        }</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;    }</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;    <span class="keywordflow">return</span> globalPointsPtr;</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;}</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classFoam_1_1globalMeshData.html#a0ba77b0b036b107db06bafe301c800f1">Foam::globalMeshData::movePoints</a>(<span class="keyword">const</span> <a class="code" href="namespaceFoam.html#a5997a67f2e85a15c0e13a1724273aa5f">pointField</a>&amp; newPoints)</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;{</div>
<div class="line"><a name="l02744"></a><span class="lineno"><a class="line" href="classFoam_1_1globalMeshData.html#ae5693a309a936ac1040dd48c2881677f"> 2744</a></span>&#160;    <span class="comment">// Topology does not change and we don&#39;t store any geometry so nothing</span></div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;    <span class="comment">// needs to be done.</span></div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;    <span class="comment">// Only global transformations might change but this is not really</span></div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;    <span class="comment">// supported.</span></div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;}</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classFoam_1_1globalMeshData.html#ae5693a309a936ac1040dd48c2881677f">Foam::globalMeshData::updateMesh</a>()</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;{</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;    <span class="comment">// Clear out old data</span></div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;    clearOut();</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;    <span class="comment">// Do processor patch addressing</span></div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;    initProcAddr();</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;    scalar tolDim = matchTol_ * mesh_.bounds().mag();</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceFoam_1_1expressions_1_1patchExpr.html#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>)</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;    {</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;        <a class="code" href="namespaceFoam.html#ad20c8f17b81fbe92f6dd235121ca1de9">Pout</a>&lt;&lt; <span class="stringliteral">&quot;globalMeshData : merge dist:&quot;</span> &lt;&lt; tolDim &lt;&lt; <a class="code" href="namespaceFoam.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;    }</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;    <span class="comment">// *** Temporary hack to avoid problems with overlapping communication</span></div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;    <span class="comment">// *** between these reductions and the calculation of deltaCoeffs</span></div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;    <span class="comment">//label comm = UPstream::worldComm + 1;</span></div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;    <a class="code" href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> comm = <a class="code" href="classFoam_1_1UPstream.html#ac189f05f0e20e7aa80f737f225250bd5">UPstream::allocateCommunicator</a></div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;    (</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;        <a class="code" href="classFoam_1_1UPstream.html#a844448bea513dc344c5b441a9e004b9d">UPstream::worldComm</a>,</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;        <a class="code" href="namespaceFoam.html#a14e1da6db5665f43c1e588eab475eabf">identity</a>(<a class="code" href="classFoam_1_1UPstream.html#aada0e04d8127eda8ee95be0772754a4f">UPstream::nProcs</a>(<a class="code" href="classFoam_1_1UPstream.html#a844448bea513dc344c5b441a9e004b9d">UPstream::worldComm</a>)),</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;        <span class="keyword">true</span></div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;    );</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;    <span class="comment">// Total number of faces.</span></div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;    nTotalFaces_ = <a class="code" href="namespaceFoam.html#a8d528a67d2a9c6fe4fb94bc86872624b">returnReduce</a></div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;    (</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;        mesh_.nFaces(),</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;        sumOp&lt;label&gt;(),</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;        <a class="code" href="classFoam_1_1UPstream.html#ae5b8fe6652f6320aa6c7f5c44b6f01b7">Pstream::msgType</a>(),</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;        comm</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;    );</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceFoam_1_1expressions_1_1patchExpr.html#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>)</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;    {</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;        <a class="code" href="namespaceFoam.html#ad20c8f17b81fbe92f6dd235121ca1de9">Pout</a>&lt;&lt; <span class="stringliteral">&quot;globalMeshData : nTotalFaces_:&quot;</span> &lt;&lt; nTotalFaces_ &lt;&lt; <a class="code" href="namespaceFoam.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;    }</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;    nTotalCells_ = <a class="code" href="namespaceFoam.html#a8d528a67d2a9c6fe4fb94bc86872624b">returnReduce</a></div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;    (</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;        mesh_.nCells(),</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;        sumOp&lt;label&gt;(),</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;        <a class="code" href="classFoam_1_1UPstream.html#ae5b8fe6652f6320aa6c7f5c44b6f01b7">Pstream::msgType</a>(),</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;        comm</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;    );</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceFoam_1_1expressions_1_1patchExpr.html#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>)</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;    {</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;        <a class="code" href="namespaceFoam.html#ad20c8f17b81fbe92f6dd235121ca1de9">Pout</a>&lt;&lt; <span class="stringliteral">&quot;globalMeshData : nTotalCells_:&quot;</span> &lt;&lt; nTotalCells_ &lt;&lt; <a class="code" href="namespaceFoam.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;    }</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;    nTotalPoints_ = <a class="code" href="namespaceFoam.html#a8d528a67d2a9c6fe4fb94bc86872624b">returnReduce</a></div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;    (</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;        mesh_.nPoints(),</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;        sumOp&lt;label&gt;(),</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;        <a class="code" href="classFoam_1_1UPstream.html#ae5b8fe6652f6320aa6c7f5c44b6f01b7">Pstream::msgType</a>(),</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;        comm</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;    );</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;    <a class="code" href="classFoam_1_1UPstream.html#a3179018baba7416f21d8f0c21bf11a62">UPstream::freeCommunicator</a>(comm);</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceFoam_1_1expressions_1_1patchExpr.html#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>)</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;    {</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;        <a class="code" href="namespaceFoam.html#ad20c8f17b81fbe92f6dd235121ca1de9">Pout</a>&lt;&lt; <span class="stringliteral">&quot;globalMeshData : nTotalPoints_:&quot;</span> &lt;&lt; nTotalPoints_ &lt;&lt; <a class="code" href="namespaceFoam.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;    }</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;}</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;<span class="comment">// ************************************************************************* //</span></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_a685585d59e2be0b937728ac25e561b93"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#a685585d59e2be0b937728ac25e561b93">Foam::globalMeshData::globalEdgeNumbering</a></div><div class="ttdeci">const globalIndex &amp; globalEdgeNumbering() const </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l02214">globalMeshData.C:2214</a></div></div>
<div class="ttc" id="namespaceFoam_html_a8d042301b1c77516c5bfd527662e4f54"><div class="ttname"><a href="namespaceFoam.html#a8d042301b1c77516c5bfd527662e4f54">Foam::labelListList</a></div><div class="ttdeci">List&lt; labelList &gt; labelListList</div><div class="ttdoc">A List of labelList. </div><div class="ttdef"><b>Definition:</b> <a href="labelList_8H_source.html#l00051">labelList.H:51</a></div></div>
<div class="ttc" id="namespaceFoam_html_a22201e6ff70f68af9d05a206ac6358b0"><div class="ttname"><a href="namespaceFoam.html#a22201e6ff70f68af9d05a206ac6358b0">Foam::mergePoints</a></div><div class="ttdeci">label mergePoints(const PointList &amp;points, const scalar mergeTol, const bool verbose, labelList &amp;pointMap, typename PointList::const_reference origin=PointList::value_type::zero)</div><div class="ttdoc">Sorts and merges points. All points closer than/equal mergeTol get merged. </div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_a0bc2673d6545cbfc0c558590a8a0cb8f"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#a0bc2673d6545cbfc0c558590a8a0cb8f">Foam::globalMeshData::sharedPointAddr</a></div><div class="ttdeci">const labelList &amp; sharedPointAddr() const </div><div class="ttdoc">Return addressing into the complete globally shared points. </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l02019">globalMeshData.C:2019</a></div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_a206c91a48fcb2446ebdd2216f199441f"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#a206c91a48fcb2446ebdd2216f199441f">Foam::globalMeshData::coupledPatchMeshEdges</a></div><div class="ttdeci">const labelList &amp; coupledPatchMeshEdges() const </div><div class="ttdoc">Return map from coupledPatch edges to mesh edges. </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l02120">globalMeshData.C:2120</a></div></div>
<div class="ttc" id="namespaceFoam_html_af09dedba9f523ce6a02baaa029393764"><div class="ttname"><a href="namespaceFoam.html#af09dedba9f523ce6a02baaa029393764">Foam::combineReduce</a></div><div class="ttdeci">void combineReduce(const List&lt; UPstream::commsStruct &gt; &amp;comms, T &amp;Value, const CombineOp &amp;cop, const int tag, const label comm)</div><div class="ttdef"><b>Definition:</b> <a href="PstreamCombineReduceOps_8H_source.html#l00048">PstreamCombineReduceOps.H:48</a></div></div>
<div class="ttc" id="namespaceFoam_html_a22f45a3cb4f074e609f58ebaeef0ecf9"><div class="ttname"><a href="namespaceFoam.html#a22f45a3cb4f074e609f58ebaeef0ecf9">Foam::label</a></div><div class="ttdeci">intWM_LABEL_SIZE_t label</div><div class="ttdoc">A label is an int32_t or int64_t as specified by the pre-processor macro WM_LABEL_SIZE. </div><div class="ttdef"><b>Definition:</b> <a href="label_8H_source.html#l00056">label.H:56</a></div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_a88daf4a4726e5a4a41e77ec8827e8fb2"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#a88daf4a4726e5a4a41e77ec8827e8fb2">Foam::globalMeshData::mergePoints</a></div><div class="ttdeci">autoPtr&lt; globalIndex &gt; mergePoints(labelList &amp;pointToGlobal, labelList &amp;uniquePoints) const </div><div class="ttdoc">Helper for merging (collocated!) mesh point data. </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l02387">globalMeshData.C:2387</a></div></div>
<div class="ttc" id="namespaceFoam_html_ac60e8d67e31d7d0aa03e70e9a6dd3217"><div class="ttname"><a href="namespaceFoam.html#ac60e8d67e31d7d0aa03e70e9a6dd3217">Foam::sort</a></div><div class="ttdeci">void sort(UList&lt; T &gt; &amp;a)</div><div class="ttdef"><b>Definition:</b> <a href="UList_8C_source.html#l00234">UList.C:234</a></div></div>
<div class="ttc" id="namespaceFoam_html_a06ca7250d8e89caf05243ec094843642"><div class="ttname"><a href="namespaceFoam.html#a06ca7250d8e89caf05243ec094843642">Foam::exit</a></div><div class="ttdeci">errorManipArg&lt; error, int &gt; exit(error &amp;err, const int errNo=1)</div><div class="ttdef"><b>Definition:</b> <a href="errorManip_8H_source.html#l00125">errorManip.H:125</a></div></div>
<div class="ttc" id="namespaceFoam_1_1expressions_1_1patchExpr_html_ac3e1795766a80ec63b157951b4b9a7d4"><div class="ttname"><a href="namespaceFoam_1_1expressions_1_1patchExpr.html#ac3e1795766a80ec63b157951b4b9a7d4">Foam::expressions::patchExpr::debug</a></div><div class="ttdeci">int debug</div><div class="ttdoc">Static debugging option. </div></div>
<div class="ttc" id="namespaceFoam_html_ac50d206700f3f71855dd30c9a076de43"><div class="ttname"><a href="namespaceFoam.html#ac50d206700f3f71855dd30c9a076de43">Foam::FatalError</a></div><div class="ttdeci">error FatalError</div><div class="ttdoc">Error stream (uses stdout - output on all processes), with additional &amp;#39;FOAM FATAL ERROR&amp;#39; header text ...</div></div>
<div class="ttc" id="error_8H_html_af2484eff8084de37cba5d9d7a00fb293"><div class="ttname"><a href="error_8H.html#af2484eff8084de37cba5d9d7a00fb293">FatalErrorInFunction</a></div><div class="ttdeci">#define FatalErrorInFunction</div><div class="ttdoc">Report an error message using Foam::FatalError. </div><div class="ttdef"><b>Definition:</b> <a href="error_8H_source.html#l00442">error.H:442</a></div></div>
<div class="ttc" id="polyMesh_8H_html"><div class="ttname"><a href="polyMesh_8H.html">polyMesh.H</a></div></div>
<div class="ttc" id="classFoam_1_1List_html"><div class="ttname"><a href="classFoam_1_1List.html">Foam::List&lt; label &gt;</a></div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_ac82996509736db81875d3cecda052a91"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#ac82996509736db81875d3cecda052a91">Foam::globalMeshData::globalPointTransformedBoundaryFaces</a></div><div class="ttdeci">const labelListList &amp; globalPointTransformedBoundaryFaces() const </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l02291">globalMeshData.C:2291</a></div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_afd21aa8d0d3c07d17271c7ae29982692"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#afd21aa8d0d3c07d17271c7ae29982692">Foam::globalMeshData::globalBoundaryCellNumbering</a></div><div class="ttdeci">const globalIndex &amp; globalBoundaryCellNumbering() const </div><div class="ttdoc">Numbering of boundary cells is according to boundaryCells() </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l02322">globalMeshData.C:2322</a></div></div>
<div class="ttc" id="globalPoints_8H_html"><div class="ttname"><a href="globalPoints_8H.html">globalPoints.H</a></div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_ac273c239bfa0b6bf0c37ece116ce813e"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#ac273c239bfa0b6bf0c37ece116ce813e">Foam::globalMeshData::globalPointSlavesMap</a></div><div class="ttdeci">const mapDistribute &amp; globalPointSlavesMap() const </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l02204">globalMeshData.C:2204</a></div></div>
<div class="ttc" id="classFoam_1_1UPstream_html_a12cf32e9b7820a2c00bf40c8617ab55ba72e9de442d0453d90fc4586a414ddaf5"><div class="ttname"><a href="classFoam_1_1UPstream.html#a12cf32e9b7820a2c00bf40c8617ab55ba72e9de442d0453d90fc4586a414ddaf5">Foam::UPstream::commsTypes::nonBlocking</a></div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_a4854ae79c476f0f62c0452c8ba5767ab"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#a4854ae79c476f0f62c0452c8ba5767ab">Foam::globalMeshData::matchTol_</a></div><div class="ttdeci">static const Foam::scalar matchTol_</div><div class="ttdoc">Geometric tolerance (fraction of bounding box) </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8H_source.html#l00417">globalMeshData.H:417</a></div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_a7009dca4882c48e17550943e7f43005b"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#a7009dca4882c48e17550943e7f43005b">Foam::globalMeshData::nGlobalEdges</a></div><div class="ttdeci">label nGlobalEdges() const </div><div class="ttdoc">Return number of globally shared edges. Demand-driven. </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l02029">globalMeshData.C:2029</a></div></div>
<div class="ttc" id="namespaceFoam_html_afbf3861e53bc13fd6c82d9eae8f97378"><div class="ttname"><a href="namespaceFoam.html#afbf3861e53bc13fd6c82d9eae8f97378">Foam::nl</a></div><div class="ttdeci">constexpr char nl</div><div class="ttdef"><b>Definition:</b> <a href="Ostream_8H_source.html#l00488">Ostream.H:488</a></div></div>
<div class="ttc" id="readKivaGrid_8H_html_a47c56be1ccc31484675aaec19dded580"><div class="ttname"><a href="readKivaGrid_8H.html#a47c56be1ccc31484675aaec19dded580">pointLabels</a></div><div class="ttdeci">labelList pointLabels(nPoints,-1)</div></div>
<div class="ttc" id="classFoam_1_1UPstream_html_afc74d89573de32a3032c916f8cdd1733"><div class="ttname"><a href="classFoam_1_1UPstream.html#afc74d89573de32a3032c916f8cdd1733">Foam::UPstream::myProcNo</a></div><div class="ttdeci">static int myProcNo(const label communicator=0)</div><div class="ttdoc">Number of this process (starting from masterNo() = 0) </div><div class="ttdef"><b>Definition:</b> <a href="UPstream_8H_source.html#l00562">UPstream.H:562</a></div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_af320697688df08f1438d37a86bcaf25d"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#af320697688df08f1438d37a86bcaf25d">Foam::globalMeshData::clearOut</a></div><div class="ttdeci">void clearOut()</div><div class="ttdoc">Remove all demand driven data. </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l01779">globalMeshData.C:1779</a></div></div>
<div class="ttc" id="classFoam_1_1UPstream_html_a83b2c4a5864f50eca8034b84f90e4874"><div class="ttname"><a href="classFoam_1_1UPstream.html#a83b2c4a5864f50eca8034b84f90e4874">Foam::UPstream::firstSlave</a></div><div class="ttdeci">static constexpr int firstSlave() noexcept</div><div class="ttdoc">Process index of first slave. </div><div class="ttdef"><b>Definition:</b> <a href="UPstream_8H_source.html#l00583">UPstream.H:583</a></div></div>
<div class="ttc" id="namespaceFoam_html_a2db8fe02a0d3909e9351bb4275b23ce4"><div class="ttname"><a href="namespaceFoam.html#a2db8fe02a0d3909e9351bb4275b23ce4">Foam::endl</a></div><div class="ttdeci">Ostream &amp; endl(Ostream &amp;os)</div><div class="ttdoc">Add newline and flush stream. </div><div class="ttdef"><b>Definition:</b> <a href="Ostream_8H_source.html#l00445">Ostream.H:445</a></div></div>
<div class="ttc" id="namespaceFoam_html_a6c8b447ab587a5b141fdabdfac4d4da3"><div class="ttname"><a href="namespaceFoam.html#a6c8b447ab587a5b141fdabdfac4d4da3">Foam::name</a></div><div class="ttdeci">word name(const complex &amp;c)</div><div class="ttdoc">Return string representation of complex. </div><div class="ttdef"><b>Definition:</b> <a href="complex_8C_source.html#l00069">complex.C:69</a></div></div>
<div class="ttc" id="stdFoam_8H_html_a93f058f99110e38d0d9d0b2d2b355175"><div class="ttname"><a href="stdFoam_8H.html#a93f058f99110e38d0d9d0b2d2b355175">forAllConstIters</a></div><div class="ttdeci">#define forAllConstIters(container, iter)</div><div class="ttdoc">Iterate across all elements of the container object with const access. </div><div class="ttdef"><b>Definition:</b> <a href="stdFoam_8H_source.html#l00283">stdFoam.H:283</a></div></div>
<div class="ttc" id="shootRays_8H_html_ac23c63c7750d8829a77f4ebe1d961c48"><div class="ttname"><a href="shootRays_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a></div><div class="ttdeci">label i</div><div class="ttdef"><b>Definition:</b> <a href="shootRays_8H_source.html#l00032">shootRays.H:32</a></div></div>
<div class="ttc" id="classFoam_1_1IOList_html"><div class="ttname"><a href="classFoam_1_1IOList.html">Foam::IOList&lt; label &gt;</a></div></div>
<div class="ttc" id="classFoam_1_1UPstream_html_a36af549940a0aae3733774649594489f"><div class="ttname"><a href="classFoam_1_1UPstream.html#a36af549940a0aae3733774649594489f">Foam::UPstream::master</a></div><div class="ttdeci">static bool master(const label communicator=0)</div><div class="ttdoc">Am I the master process. </div><div class="ttdef"><b>Definition:</b> <a href="UPstream_8H_source.html#l00554">UPstream.H:554</a></div></div>
<div class="ttc" id="classFoam_1_1globalIndex_html_a32d192139d7d41bb8c736fc9f7a38929"><div class="ttname"><a href="classFoam_1_1globalIndex.html#a32d192139d7d41bb8c736fc9f7a38929">Foam::globalIndex::reset</a></div><div class="ttdeci">void reset(const label localSize)</div><div class="ttdoc">Reset from local size. </div><div class="ttdef"><b>Definition:</b> <a href="globalIndexI_8H_source.html#l00087">globalIndexI.H:87</a></div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_ad78653dfabd687626d66d1a1bc336ec7"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#ad78653dfabd687626d66d1a1bc336ec7">Foam::globalMeshData::sharedEdgeLabels</a></div><div class="ttdeci">const labelList &amp; sharedEdgeLabels() const </div><div class="ttdoc">Return indices of local edges that are globally shared. </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l02039">globalMeshData.C:2039</a></div></div>
<div class="ttc" id="classFoam_1_1UPstream_html_ae5b8fe6652f6320aa6c7f5c44b6f01b7"><div class="ttname"><a href="classFoam_1_1UPstream.html#ae5b8fe6652f6320aa6c7f5c44b6f01b7">Foam::UPstream::msgType</a></div><div class="ttdeci">static int &amp; msgType()</div><div class="ttdoc">Message tag of standard messages. </div><div class="ttdef"><b>Definition:</b> <a href="UPstream_8H_source.html#l00621">UPstream.H:621</a></div></div>
<div class="ttc" id="classFoam_1_1UPstream_html_a844448bea513dc344c5b441a9e004b9d"><div class="ttname"><a href="classFoam_1_1UPstream.html#a844448bea513dc344c5b441a9e004b9d">Foam::UPstream::worldComm</a></div><div class="ttdeci">static label worldComm</div><div class="ttdoc">Default communicator (all processors) </div><div class="ttdef"><b>Definition:</b> <a href="UPstream_8H_source.html#l00351">UPstream.H:351</a></div></div>
<div class="ttc" id="namespaceFoam_html_ade12cb9748f8411c22f9725b2cad88e3"><div class="ttname"><a href="namespaceFoam.html#ade12cb9748f8411c22f9725b2cad88e3">Foam::indirectPrimitivePatch</a></div><div class="ttdeci">PrimitivePatch&lt; face, IndirectList, const pointField &amp; &gt; indirectPrimitivePatch</div><div class="ttdoc">A PrimitivePatch using an IndirectList for the faces. </div><div class="ttdef"><b>Definition:</b> <a href="indirectPrimitivePatch_8H_source.html#l00041">indirectPrimitivePatch.H:41</a></div></div>
<div class="ttc" id="namespaceFoam_html_a30cf573386bba5460dafb158b03611b0"><div class="ttname"><a href="namespaceFoam.html#a30cf573386bba5460dafb158b03611b0">Foam::processorTopology</a></div><div class="ttdeci">ProcessorTopology&lt; polyPatchList, processorPolyPatch &gt; processorTopology</div><div class="ttdef"><b>Definition:</b> <a href="processorTopology_8H_source.html#l00034">processorTopology.H:34</a></div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_a46e0f83a5e64f815d61733c92c275f89"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#a46e0f83a5e64f815d61733c92c275f89">Foam::globalMeshData::globalPointSlaves</a></div><div class="ttdeci">const labelListList &amp; globalPointSlaves() const </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l02183">globalMeshData.C:2183</a></div></div>
<div class="ttc" id="namespaceFoam_1_1constant_1_1atomic_html_ad3f3be5d088879a8898b5f0d96e3633c"><div class="ttname"><a href="namespaceFoam_1_1constant_1_1atomic.html#ad3f3be5d088879a8898b5f0d96e3633c">Foam::constant::atomic::me</a></div><div class="ttdeci">const dimensionedScalar me</div><div class="ttdoc">Electron mass. </div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_adbad6117287bd1af50003e06464c2db6"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#adbad6117287bd1af50003e06464c2db6">Foam::globalMeshData::globalPointTransformedBoundaryCells</a></div><div class="ttdeci">const labelListList &amp; globalPointTransformedBoundaryCells() const </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l02345">globalMeshData.C:2345</a></div></div>
<div class="ttc" id="namespaceFoam_html_aa94edac9dd43dd3114964d552001710e"><div class="ttname"><a href="namespaceFoam.html#aa94edac9dd43dd3114964d552001710e">Foam::less</a></div><div class="ttdeci">static bool less(const vector &amp;x, const vector &amp;y)</div><div class="ttdoc">To compare normals. </div><div class="ttdef"><b>Definition:</b> <a href="meshRefinementRefine_8C_source.html#l00052">meshRefinementRefine.C:52</a></div></div>
<div class="ttc" id="classFoam_1_1polyMesh_html_a6b7f5ba89250dbd7a1c6c7860ab60fe3"><div class="ttname"><a href="classFoam_1_1polyMesh.html#a6b7f5ba89250dbd7a1c6c7860ab60fe3">Foam::polyMesh::boundaryMesh</a></div><div class="ttdeci">const polyBoundaryMesh &amp; boundaryMesh() const </div><div class="ttdoc">Return boundary mesh. </div><div class="ttdef"><b>Definition:</b> <a href="polyMesh_8H_source.html#l00549">polyMesh.H:549</a></div></div>
<div class="ttc" id="PstreamCombineReduceOps_8H_html"><div class="ttname"><a href="PstreamCombineReduceOps_8H.html">PstreamCombineReduceOps.H</a></div><div class="ttdoc">Combination-Reduction operation for a parallel run. The information from all nodes is collected on th...</div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_a76ea4aeaea723e10a265a12de1b4e076"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#a76ea4aeaea723e10a265a12de1b4e076">Foam::globalMeshData::globalPointNumbering</a></div><div class="ttdeci">const globalIndex &amp; globalPointNumbering() const </div><div class="ttdoc">Numbering of coupled points is according to coupledPatch. </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l02159">globalMeshData.C:2159</a></div></div>
<div class="ttc" id="stdFoam_8H_html_a1a02bffef961ee015f0e9b03d336c6a9"><div class="ttname"><a href="stdFoam_8H.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a></div><div class="ttdeci">#define forAll(list, i)</div><div class="ttdoc">Loop across all elements in list. </div><div class="ttdef"><b>Definition:</b> <a href="stdFoam_8H_source.html#l00347">stdFoam.H:347</a></div></div>
<div class="ttc" id="LISASMDCalcMethod2_8H_html_a9336ebf25087d91c818ee6e9ec29f8c1"><div class="ttname"><a href="LISASMDCalcMethod2_8H.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a></div><div class="ttdeci">x</div><div class="ttdef"><b>Definition:</b> <a href="LISASMDCalcMethod2_8H_source.html#l00052">LISASMDCalcMethod2.H:52</a></div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_a69b81b4b8c33b94c94440bc3d7dc3e88"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#a69b81b4b8c33b94c94440bc3d7dc3e88">Foam::globalMeshData::sharedPoints</a></div><div class="ttdeci">pointField sharedPoints() const </div><div class="ttdoc">Collect coordinates of shared points on all processors. </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l01882">globalMeshData.C:1882</a></div></div>
<div class="ttc" id="LISASMDCalcMethod1_8H_html_afa8b67a0d5607da908ad92ed485e19e8"><div class="ttname"><a href="LISASMDCalcMethod1_8H.html#afa8b67a0d5607da908ad92ed485e19e8">y</a></div><div class="ttdeci">scalar y</div><div class="ttdef"><b>Definition:</b> <a href="LISASMDCalcMethod1_8H_source.html#l00014">LISASMDCalcMethod1.H:14</a></div></div>
<div class="ttc" id="classFoam_1_1PrimitivePatch_html"><div class="ttname"><a href="classFoam_1_1PrimitivePatch.html">Foam::PrimitivePatch</a></div><div class="ttdoc">A list of faces which address into the list of points. </div><div class="ttdef"><b>Definition:</b> <a href="PrimitivePatch_8H_source.html#l00086">PrimitivePatch.H:86</a></div></div>
<div class="ttc" id="classFoam_1_1globalIndex_html"><div class="ttname"><a href="classFoam_1_1globalIndex.html">Foam::globalIndex</a></div><div class="ttdoc">Calculates a unique integer (label so might not have enough room - 2G max) for processor + local inde...</div><div class="ttdef"><b>Definition:</b> <a href="globalIndex_8H_source.html#l00064">globalIndex.H:64</a></div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_a65cb0910fd37597865619cf548843aa0"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#a65cb0910fd37597865619cf548843aa0">Foam::globalMeshData::globalBoundaryFaceNumbering</a></div><div class="ttdeci">const globalIndex &amp; globalBoundaryFaceNumbering() const </div><div class="ttdoc">Numbering of boundary faces is face-mesh.nInternalFaces() </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l02268">globalMeshData.C:2268</a></div></div>
<div class="ttc" id="namespaceFoam_html_a5997a67f2e85a15c0e13a1724273aa5f"><div class="ttname"><a href="namespaceFoam.html#a5997a67f2e85a15c0e13a1724273aa5f">Foam::pointField</a></div><div class="ttdeci">vectorField pointField</div><div class="ttdoc">pointField is a vectorField. </div><div class="ttdef"><b>Definition:</b> <a href="pointFieldFwd_8H_source.html#l00038">pointFieldFwd.H:38</a></div></div>
<div class="ttc" id="namespaceFoam_1_1constant_1_1electromagnetic_html_a1885f51cb0544664f4e80e895d163fc8"><div class="ttname"><a href="namespaceFoam_1_1constant_1_1electromagnetic.html#a1885f51cb0544664f4e80e895d163fc8">Foam::constant::electromagnetic::e</a></div><div class="ttdeci">const dimensionedScalar e</div><div class="ttdoc">Elementary charge. </div><div class="ttdef"><b>Definition:</b> <a href="solvers_2compressible_2rhoCentralFoam_2createFields_8H_source.html#l00011">createFields.H:11</a></div></div>
<div class="ttc" id="classFoam_1_1List_html_a3eb74b6b9f8c1346a09c49e3eade797c"><div class="ttname"><a href="classFoam_1_1List.html#a3eb74b6b9f8c1346a09c49e3eade797c">Foam::List::setSize</a></div><div class="ttdeci">void setSize(const label newSize)</div><div class="ttdoc">Alias for resize(const label) </div><div class="ttdef"><b>Definition:</b> <a href="ListI_8H_source.html#l00139">ListI.H:139</a></div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_a1fcda682b7be60ff6140dbc752924d7c"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#a1fcda682b7be60ff6140dbc752924d7c">Foam::globalMeshData::globalCoPointSlaves</a></div><div class="ttdeci">const labelListList &amp; globalCoPointSlaves() const </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l02366">globalMeshData.C:2366</a></div></div>
<div class="ttc" id="createDynamicFvMesh_8H_html_a4c1de256df6b3d186a85745b3149394a"><div class="ttname"><a href="createDynamicFvMesh_8H.html#a4c1de256df6b3d186a85745b3149394a">mesh</a></div><div class="ttdeci">dynamicFvMesh &amp; mesh</div><div class="ttdef"><b>Definition:</b> <a href="createDynamicFvMesh_8H_source.html#l00006">createDynamicFvMesh.H:6</a></div></div>
<div class="ttc" id="classFoam_1_1Pair_html"><div class="ttname"><a href="classFoam_1_1Pair.html">Foam::Pair</a></div><div class="ttdoc">An ordered pair of two objects of type &amp;lt;T&amp;gt; with first() and second() elements. </div><div class="ttdef"><b>Definition:</b> <a href="Pair_8H_source.html#l00050">Pair.H:50</a></div></div>
<div class="ttc" id="structFoam_1_1minEqOp_html"><div class="ttname"><a href="structFoam_1_1minEqOp.html">Foam::minEqOp</a></div><div class="ttdef"><b>Definition:</b> <a href="ops_8H_source.html#l00075">ops.H:75</a></div></div>
<div class="ttc" id="namespaceFoam_html_ac74e20afd12e634897e4a0b62666e33b"><div class="ttname"><a href="namespaceFoam.html#ac74e20afd12e634897e4a0b62666e33b">Foam::edgeList</a></div><div class="ttdeci">List&lt; edge &gt; edgeList</div><div class="ttdoc">A List of edges. </div><div class="ttdef"><b>Definition:</b> <a href="edgeList_8H_source.html#l00060">edgeList.H:60</a></div></div>
<div class="ttc" id="classFoam_1_1Pair_html_aa49b2c738e8fa9b70727f3a3efb22908"><div class="ttname"><a href="classFoam_1_1Pair.html#aa49b2c738e8fa9b70727f3a3efb22908">Foam::Pair::compare</a></div><div class="ttdeci">static int compare(const Pair&lt; T &gt; &amp;a, const Pair&lt; T &gt; &amp;b)</div><div class="ttdoc">Compare Pairs. </div><div class="ttdef"><b>Definition:</b> <a href="PairI_8H_source.html#l00026">PairI.H:26</a></div></div>
<div class="ttc" id="namespaceFoam_html_a14e1da6db5665f43c1e588eab475eabf"><div class="ttname"><a href="namespaceFoam.html#a14e1da6db5665f43c1e588eab475eabf">Foam::identity</a></div><div class="ttdeci">labelList identity(const label len, label start=0)</div><div class="ttdoc">Create identity map of the given length with (map[i] == i) </div><div class="ttdef"><b>Definition:</b> <a href="labelList_8C_source.html#l00031">labelList.C:31</a></div></div>
<div class="ttc" id="classFoam_1_1Field_html"><div class="ttname"><a href="classFoam_1_1Field.html">Foam::Field&lt; vector &gt;</a></div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_a8282ee27862ac1816cc8f23af2e3a7d1"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#a8282ee27862ac1816cc8f23af2e3a7d1">Foam::globalMeshData::globalPointBoundaryCells</a></div><div class="ttdeci">const labelListList &amp; globalPointBoundaryCells() const </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l02333">globalMeshData.C:2333</a></div></div>
<div class="ttc" id="gmvOutputHeader_8H_html_a4e3cff1e2db0a2643803f58beab1a643"><div class="ttname"><a href="gmvOutputHeader_8H.html#a4e3cff1e2db0a2643803f58beab1a643">nPoints</a></div><div class="ttdeci">label nPoints</div><div class="ttdef"><b>Definition:</b> <a href="gmvOutputHeader_8H_source.html#l00002">gmvOutputHeader.H:2</a></div></div>
<div class="ttc" id="Pstream_8H_html"><div class="ttname"><a href="Pstream_8H.html">Pstream.H</a></div></div>
<div class="ttc" id="createBlockMesh_8H_html_abc31dc51aef6737bee199e876a8dffb5"><div class="ttname"><a href="createBlockMesh_8H.html#abc31dc51aef6737bee199e876a8dffb5">bCells</a></div><div class="ttdeci">Info&lt;&lt; &quot;Creating cells&quot;&lt;&lt; endl;List&lt; FixedList&lt; label, 8 &gt; &gt; bCells(b.cells())</div></div>
<div class="ttc" id="classFoam_1_1UPstream_html_a40c4d875df4ff7c32f30f6f596b0f4f8"><div class="ttname"><a href="classFoam_1_1UPstream.html#a40c4d875df4ff7c32f30f6f596b0f4f8">Foam::UPstream::masterNo</a></div><div class="ttdeci">static constexpr int masterNo() noexcept</div><div class="ttdoc">Process index of the master. </div><div class="ttdef"><b>Definition:</b> <a href="UPstream_8H_source.html#l00546">UPstream.H:546</a></div></div>
<div class="ttc" id="classFoam_1_1UPtrList_html_a95603446b248fe1ecf5dc59bcc2eaff0"><div class="ttname"><a href="classFoam_1_1UPtrList.html#a95603446b248fe1ecf5dc59bcc2eaff0">Foam::UPtrList::size</a></div><div class="ttdeci">label size() const noexcept</div><div class="ttdoc">The number of elements in the list. </div><div class="ttdef"><b>Definition:</b> <a href="UPtrListI_8H_source.html#l00083">UPtrListI.H:83</a></div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_a9514865a59c04a319922b8f49a151ba7"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#a9514865a59c04a319922b8f49a151ba7">Foam::globalMeshData::geometricSharedPoints</a></div><div class="ttdeci">pointField geometricSharedPoints() const </div><div class="ttdoc">Like sharedPoints but keeps cyclic points separate. </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l01971">globalMeshData.C:1971</a></div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_a129f840ab6aec51848f78b9729fe64a9"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#a129f840ab6aec51848f78b9729fe64a9">Foam::globalMeshData::globalPointBoundaryCellsMap</a></div><div class="ttdeci">const mapDistribute &amp; globalPointBoundaryCellsMap() const </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l02355">globalMeshData.C:2355</a></div></div>
<div class="ttc" id="namespaceFoam_html_a112dcff843d9704157222600fe0647c5"><div class="ttname"><a href="namespaceFoam.html#a112dcff843d9704157222600fe0647c5">Foam::labelPairList</a></div><div class="ttdeci">List&lt; labelPair &gt; labelPairList</div><div class="ttdoc">List of labelPairs. </div><div class="ttdef"><b>Definition:</b> <a href="labelPair_8H_source.html#l00061">labelPair.H:61</a></div></div>
<div class="ttc" id="namespaceFoam_html_a96b65441175bbfb9a869045dc05fb0b9"><div class="ttname"><a href="namespaceFoam.html#a96b65441175bbfb9a869045dc05fb0b9">Foam::min</a></div><div class="ttdeci">label min(const labelHashSet &amp;set, label minValue=labelMax)</div><div class="ttdoc">Find the min value in labelHashSet, optionally limited by second argument. </div><div class="ttdef"><b>Definition:</b> <a href="hashSets_8C_source.html#l00026">hashSets.C:26</a></div></div>
<div class="ttc" id="namespaceFoam_html_a447107a607d03e417307c203fa5fb44b"><div class="ttname"><a href="namespaceFoam.html#a447107a607d03e417307c203fa5fb44b">Foam::abort</a></div><div class="ttdeci">errorManip&lt; error &gt; abort(error &amp;err)</div><div class="ttdef"><b>Definition:</b> <a href="errorManip_8H_source.html#l00132">errorManip.H:132</a></div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_a067b1361a138e9d2c68277599f43ebe6"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#a067b1361a138e9d2c68277599f43ebe6">Foam::globalMeshData::globalEdgeSlavesMap</a></div><div class="ttdeci">const mapDistribute &amp; globalEdgeSlavesMap() const </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l02258">globalMeshData.C:2258</a></div></div>
<div class="ttc" id="classFoam_1_1dimensionSet_html_acec8127b4d70f4670e8a518c2ee61615"><div class="ttname"><a href="classFoam_1_1dimensionSet.html#acec8127b4d70f4670e8a518c2ee61615">Foam::dimensionSet::reset</a></div><div class="ttdeci">void reset(const dimensionSet &amp;ds)</div><div class="ttdoc">Copy assign the exponents from the dimensionSet. </div><div class="ttdef"><b>Definition:</b> <a href="dimensionSet_8C_source.html#l00140">dimensionSet.C:140</a></div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_afbcae5ee9ab7ebe172d3809f611d745d"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#afbcae5ee9ab7ebe172d3809f611d745d">Foam::globalMeshData::coupledPatch</a></div><div class="ttdeci">const indirectPrimitivePatch &amp; coupledPatch() const </div><div class="ttdoc">Return patch of all coupled faces. </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l02059">globalMeshData.C:2059</a></div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_a6c50db3dabc2d62e0af8cce92919e697"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#a6c50db3dabc2d62e0af8cce92919e697">Foam::globalMeshData::globalTransforms</a></div><div class="ttdeci">const globalIndexAndTransform &amp; globalTransforms() const </div><div class="ttdoc">Global transforms numbering. </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l02173">globalMeshData.C:2173</a></div></div>
<div class="ttc" id="namespaceFoam_html_a0b89283d807abdc103060edb7f371b1f"><div class="ttname"><a href="namespaceFoam.html#a0b89283d807abdc103060edb7f371b1f">Foam::labelPair</a></div><div class="ttdeci">Pair&lt; label &gt; labelPair</div><div class="ttdoc">A pair of labels. </div><div class="ttdef"><b>Definition:</b> <a href="Pair_8H_source.html#l00050">Pair.H:50</a></div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_aa34d80c5b139b7ee4416a6432c451fac"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#aa34d80c5b139b7ee4416a6432c451fac">Foam::globalMeshData::~globalMeshData</a></div><div class="ttdeci">~globalMeshData()</div><div class="ttdoc">Destructor. </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l01773">globalMeshData.C:1773</a></div></div>
<div class="ttc" id="namespaceFoam_html_a9907f9d4272b10c75ac87c1679b77c24"><div class="ttname"><a href="namespaceFoam.html#a9907f9d4272b10c75ac87c1679b77c24">Foam::defineTypeNameAndDebug</a></div><div class="ttdeci">defineTypeNameAndDebug(combustionModel, 0)</div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_ab52285621ca75e00b03f68a0a65c16bc"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#ab52285621ca75e00b03f68a0a65c16bc">Foam::globalMeshData::globalCoPointSlavesMap</a></div><div class="ttdeci">const mapDistribute &amp; globalCoPointSlavesMap() const </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l02376">globalMeshData.C:2376</a></div></div>
<div class="ttc" id="mergePoints_8H_html"><div class="ttname"><a href="mergePoints_8H.html">mergePoints.H</a></div><div class="ttdoc">Merge points. See below. </div></div>
<div class="ttc" id="readKivaGrid_8H_html_a888be93833ac7a23170555c69c690288"><div class="ttname"><a href="readKivaGrid_8H.html#a888be93833ac7a23170555c69c690288">f</a></div><div class="ttdeci">labelList f(nPoints)</div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_a2c591aed92bccffe0d99b4f1b45a5de0"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#a2c591aed92bccffe0d99b4f1b45a5de0">Foam::globalMeshData::globalEdgeTransformedSlaves</a></div><div class="ttdeci">const labelListList &amp; globalEdgeTransformedSlaves() const </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l02237">globalMeshData.C:2237</a></div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_abd89d808383f6e1c648e7098db5ac58c"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#abd89d808383f6e1c648e7098db5ac58c">Foam::globalMeshData::boundaryCells</a></div><div class="ttdeci">const labelList &amp; boundaryCells() const </div><div class="ttdoc">From boundary cell to mesh cell. </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l02312">globalMeshData.C:2312</a></div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_a0ba77b0b036b107db06bafe301c800f1"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#a0ba77b0b036b107db06bafe301c800f1">Foam::globalMeshData::movePoints</a></div><div class="ttdeci">void movePoints(const pointField &amp;newPoints)</div><div class="ttdoc">Update for moving points. </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l02735">globalMeshData.C:2735</a></div></div>
<div class="ttc" id="globalIndexAndTransform_8H_html"><div class="ttname"><a href="globalIndexAndTransform_8H.html">globalIndexAndTransform.H</a></div></div>
<div class="ttc" id="classFoam_1_1UPstream_html_a12cf32e9b7820a2c00bf40c8617ab55ba14343966a1d7dce7526e57cf2206d19d"><div class="ttname"><a href="classFoam_1_1UPstream.html#a12cf32e9b7820a2c00bf40c8617ab55ba14343966a1d7dce7526e57cf2206d19d">Foam::UPstream::commsTypes::blocking</a></div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_a3d0705ed797e2121c43c4bdd2d510f44"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#a3d0705ed797e2121c43c4bdd2d510f44">Foam::globalMeshData::globalPointTransformedSlaves</a></div><div class="ttdeci">const labelListList &amp; globalPointTransformedSlaves() const </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l02193">globalMeshData.C:2193</a></div></div>
<div class="ttc" id="classFoam_1_1UPstream_html_adbb27f04b5705440fb8b09f278059011"><div class="ttname"><a href="classFoam_1_1UPstream.html#adbb27f04b5705440fb8b09f278059011">Foam::UPstream::parRun</a></div><div class="ttdeci">static bool &amp; parRun()</div><div class="ttdoc">Is this a parallel run? </div><div class="ttdef"><b>Definition:</b> <a href="UPstream_8H_source.html#l00522">UPstream.H:522</a></div></div>
<div class="ttc" id="classFoam_1_1UPstream_html_aada0e04d8127eda8ee95be0772754a4f"><div class="ttname"><a href="classFoam_1_1UPstream.html#aada0e04d8127eda8ee95be0772754a4f">Foam::UPstream::nProcs</a></div><div class="ttdeci">static label nProcs(const label communicator=0)</div><div class="ttdoc">Number of processes in parallel run. </div><div class="ttdef"><b>Definition:</b> <a href="UPstream_8H_source.html#l00538">UPstream.H:538</a></div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_a5082336c19e331472eba8bcbcef56d44"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#a5082336c19e331472eba8bcbcef56d44">Foam::globalMeshData::sharedEdgeAddr</a></div><div class="ttdeci">const labelList &amp; sharedEdgeAddr() const </div><div class="ttdoc">Return addressing into the complete globally shared edge. </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l02049">globalMeshData.C:2049</a></div></div>
<div class="ttc" id="classFoam_1_1mapDistribute_html"><div class="ttname"><a href="classFoam_1_1mapDistribute.html">Foam::mapDistribute</a></div><div class="ttdoc">Class containing processor-to-processor mapping information. </div><div class="ttdef"><b>Definition:</b> <a href="mapDistribute_8H_source.html#l00159">mapDistribute.H:159</a></div></div>
<div class="ttc" id="globalMeshData_8H_html"><div class="ttname"><a href="globalMeshData_8H.html">globalMeshData.H</a></div></div>
<div class="ttc" id="classFoam_1_1bitSet_html"><div class="ttname"><a href="classFoam_1_1bitSet.html">Foam::bitSet</a></div><div class="ttdoc">A bitSet stores bits (elements with only two states) in packed internal format and supports a variety...</div><div class="ttdef"><b>Definition:</b> <a href="bitSet_8H_source.html#l00060">bitSet.H:60</a></div></div>
<div class="ttc" id="processorPolyPatch_8H_html"><div class="ttname"><a href="processorPolyPatch_8H.html">processorPolyPatch.H</a></div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_a2fe434058aaa65022a8f6784f9c20cfa"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#a2fe434058aaa65022a8f6784f9c20cfa">Foam::globalMeshData::globalEdgeSlaves</a></div><div class="ttdeci">const labelListList &amp; globalEdgeSlaves() const </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l02227">globalMeshData.C:2227</a></div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_ae5693a309a936ac1040dd48c2881677f"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#ae5693a309a936ac1040dd48c2881677f">Foam::globalMeshData::updateMesh</a></div><div class="ttdeci">void updateMesh()</div><div class="ttdoc">Change global mesh data given a topological change. Does a. </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l02744">globalMeshData.C:2744</a></div></div>
<div class="ttc" id="shootRays_8H_html_a26c8668e6da16a9f1bf37a8829e5a7db"><div class="ttname"><a href="shootRays_8H.html#a26c8668e6da16a9f1bf37a8829e5a7db">j</a></div><div class="ttdeci">label j</div><div class="ttdef"><b>Definition:</b> <a href="shootRays_8H_source.html#l00033">shootRays.H:33</a></div></div>
<div class="ttc" id="namespaceFoam_html_a700fe3bfa3b7c2f5937307d76372ab4e"><div class="ttname"><a href="namespaceFoam.html#a700fe3bfa3b7c2f5937307d76372ab4e">Foam::labelMax</a></div><div class="ttdeci">constexpr label labelMax</div><div class="ttdef"><b>Definition:</b> <a href="label_8H_source.html#l00059">label.H:59</a></div></div>
<div class="ttc" id="TABSMDCalcMethod2_8H_html_a830e93cc5b8d859299d1a788c12be8ac"><div class="ttname"><a href="TABSMDCalcMethod2_8H.html#a830e93cc5b8d859299d1a788c12be8ac">n</a></div><div class="ttdeci">label n</div><div class="ttdef"><b>Definition:</b> <a href="TABSMDCalcMethod2_8H_source.html#l00031">TABSMDCalcMethod2.H:31</a></div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_a312c00277bb50bcf3843c3a08c8642ea"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#a312c00277bb50bcf3843c3a08c8642ea">Foam::globalMeshData::globalPointBoundaryFaces</a></div><div class="ttdeci">const labelListList &amp; globalPointBoundaryFaces() const </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l02279">globalMeshData.C:2279</a></div></div>
<div class="ttc" id="namespaceFoam_html_a8d528a67d2a9c6fe4fb94bc86872624b"><div class="ttname"><a href="namespaceFoam.html#a8d528a67d2a9c6fe4fb94bc86872624b">Foam::returnReduce</a></div><div class="ttdeci">T returnReduce(const T &amp;Value, const BinaryOp &amp;bop, const int tag=Pstream::msgType(), const label comm=UPstream::worldComm)</div><div class="ttdef"><b>Definition:</b> <a href="PstreamReduceOps_8H_source.html#l00088">PstreamReduceOps.H:88</a></div></div>
<div class="ttc" id="classFoam_1_1autoPtr_html"><div class="ttname"><a href="classFoam_1_1autoPtr.html">Foam::autoPtr&lt; Foam::globalIndex &gt;</a></div></div>
<div class="ttc" id="mapDistribute_8H_html"><div class="ttname"><a href="mapDistribute_8H.html">mapDistribute.H</a></div></div>
<div class="ttc" id="namespaceFoam_html_a24c22a63812a3886a7f46967366a0671"><div class="ttname"><a href="namespaceFoam.html#a24c22a63812a3886a7f46967366a0671">Foam::labelList</a></div><div class="ttdeci">List&lt; label &gt; labelList</div><div class="ttdoc">A List of labels. </div><div class="ttdef"><b>Definition:</b> <a href="List_8H_source.html#l00070">List.H:70</a></div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_af40f098f2f1db79c818d0ba6b7a1fd42"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#af40f098f2f1db79c818d0ba6b7a1fd42">Foam::globalMeshData::sharedPointLabels</a></div><div class="ttdeci">const labelList &amp; sharedPointLabels() const </div><div class="ttdoc">Return indices of local points that are globally shared. </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l02009">globalMeshData.C:2009</a></div></div>
<div class="ttc" id="classFoam_1_1UPstream_html_ac189f05f0e20e7aa80f737f225250bd5"><div class="ttname"><a href="classFoam_1_1UPstream.html#ac189f05f0e20e7aa80f737f225250bd5">Foam::UPstream::allocateCommunicator</a></div><div class="ttdeci">static label allocateCommunicator(const label parent, const labelList &amp;subRanks, const bool doPstream=true)</div><div class="ttdoc">Allocate a new communicator. </div><div class="ttdef"><b>Definition:</b> <a href="OpenFOAM_2db_2IOstreams_2Pstreams_2UPstream_8C_source.html#l00093">UPstream.C:93</a></div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_a68fe01255a021a4fae072146a6274076"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#a68fe01255a021a4fae072146a6274076">Foam::globalMeshData::coupledPatchMeshEdgeMap</a></div><div class="ttdeci">const Map&lt; label &gt; &amp; coupledPatchMeshEdgeMap() const </div><div class="ttdoc">Return map from mesh edges to coupledPatch edges. </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l02140">globalMeshData.C:2140</a></div></div>
<div class="ttc" id="namespaceFoam_html_a1fc621b18cd1d8a786e42733c2657a1a"><div class="ttname"><a href="namespaceFoam.html#a1fc621b18cd1d8a786e42733c2657a1a">Foam::transform</a></div><div class="ttdeci">dimensionSet transform(const dimensionSet &amp;ds)</div><div class="ttdoc">Return the argument; transformations do not change the dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="dimensionSet_8C_source.html#l00512">dimensionSet.C:512</a></div></div>
<div class="ttc" id="classFoam_1_1IOobject_html_afb15664dd6f862c31c963d58b4205f93a9e7b8f2e0979fecd1bbc84564f3d3891"><div class="ttname"><a href="classFoam_1_1IOobject.html#afb15664dd6f862c31c963d58b4205f93a9e7b8f2e0979fecd1bbc84564f3d3891">Foam::IOobject::MUST_READ</a></div><div class="ttdef"><b>Definition:</b> <a href="IOobject_8H_source.html#l00120">IOobject.H:120</a></div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_a2202dd86fabf30f1eab44a33a9c8f56a"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#a2202dd86fabf30f1eab44a33a9c8f56a">Foam::globalMeshData::globalPointBoundaryFacesMap</a></div><div class="ttdeci">const mapDistribute &amp; globalPointBoundaryFacesMap() const </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l02301">globalMeshData.C:2301</a></div></div>
<div class="ttc" id="classFoam_1_1IOobject_html"><div class="ttname"><a href="classFoam_1_1IOobject.html">Foam::IOobject</a></div><div class="ttdoc">Defines the attributes of an object for which implicit objectRegistry management is supported...</div><div class="ttdef"><b>Definition:</b> <a href="IOobject_8H_source.html#l00100">IOobject.H:100</a></div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_a36192734fad53b19cb1ee41fb3deb998"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#a36192734fad53b19cb1ee41fb3deb998">Foam::globalMeshData::nGlobalPoints</a></div><div class="ttdeci">label nGlobalPoints() const </div><div class="ttdoc">Return number of globally shared points. </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l01999">globalMeshData.C:1999</a></div></div>
<div class="ttc" id="namespaceFoam_html_aadf0ae71dff07b55b32f722f83b2621d"><div class="ttname"><a href="namespaceFoam.html#aadf0ae71dff07b55b32f722f83b2621d">Foam::bMesh</a></div><div class="ttdeci">PrimitivePatch&lt; face, List, const pointField &gt; bMesh</div><div class="ttdoc">Holder of faceList and points. (v.s. e.g. primitivePatch which references points) ...</div><div class="ttdef"><b>Definition:</b> <a href="bMesh_8H_source.html#l00041">bMesh.H:41</a></div></div>
<div class="ttc" id="shootRays_8H_html_a1fc3ae6bd5c6a80e9b81b27fc7b7a11a"><div class="ttname"><a href="shootRays_8H.html#a1fc3ae6bd5c6a80e9b81b27fc7b7a11a">iter</a></div><div class="ttdeci">label iter</div><div class="ttdef"><b>Definition:</b> <a href="shootRays_8H_source.html#l00114">shootRays.H:114</a></div></div>
<div class="ttc" id="structFoam_1_1minEqOp_html_a7a57bfb4b15d7267a89d15acd1e958cd"><div class="ttname"><a href="structFoam_1_1minEqOp.html#a7a57bfb4b15d7267a89d15acd1e958cd">Foam::minEqOp::operator()</a></div><div class="ttdeci">void operator()(T &amp;x, const T &amp;y) const </div><div class="ttdef"><b>Definition:</b> <a href="ops_8H_source.html#l00075">ops.H:75</a></div></div>
<div class="ttc" id="TABSMDCalcMethod2_8H_html_a7141f237b2648c631ce5b73215683565"><div class="ttname"><a href="TABSMDCalcMethod2_8H.html#a7141f237b2648c631ce5b73215683565">found</a></div><div class="ttdeci">bool found</div><div class="ttdef"><b>Definition:</b> <a href="TABSMDCalcMethod2_8H_source.html#l00032">TABSMDCalcMethod2.H:32</a></div></div>
<div class="ttc" id="labelIOList_8H_html"><div class="ttname"><a href="labelIOList_8H.html">labelIOList.H</a></div></div>
<div class="ttc" id="namespaceFoam_html_ad20c8f17b81fbe92f6dd235121ca1de9"><div class="ttname"><a href="namespaceFoam.html#ad20c8f17b81fbe92f6dd235121ca1de9">Foam::Pout</a></div><div class="ttdeci">prefixOSstream Pout</div><div class="ttdoc">An Ostream wrapper for parallel output to std::cout. </div></div>
<div class="ttc" id="classFoam_1_1UPstream_html_a3179018baba7416f21d8f0c21bf11a62"><div class="ttname"><a href="classFoam_1_1UPstream.html#a3179018baba7416f21d8f0c21bf11a62">Foam::UPstream::freeCommunicator</a></div><div class="ttdeci">static void freeCommunicator(const label communicator, const bool doPstream=true)</div><div class="ttdoc">Free a previously allocated communicator. </div><div class="ttdef"><b>Definition:</b> <a href="OpenFOAM_2db_2IOstreams_2Pstreams_2UPstream_8C_source.html#l00159">UPstream.C:159</a></div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_ad792c3d93b64d7531318acf72417f30c"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#ad792c3d93b64d7531318acf72417f30c">Foam::globalMeshData::sharedPointGlobalLabels</a></div><div class="ttdeci">const labelList &amp; sharedPointGlobalLabels() const </div><div class="ttdoc">Return shared point global labels. Tries to read. </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l01831">globalMeshData.C:1831</a></div></div>
<div class="ttc" id="classFoam_1_1globalIndexAndTransform_html"><div class="ttname"><a href="classFoam_1_1globalIndexAndTransform.html">Foam::globalIndexAndTransform</a></div><div class="ttdoc">Determination and storage of the possible independent transforms introduced by coupledPolyPatches, as well as all of the possible permutations of these transforms generated by the presence of multiple coupledPolyPatches, i.e. more than one cyclic boundary. Note that any given point can be on maximum 3 transforms only (and these transforms have to be perpendicular) </div><div class="ttdef"><b>Definition:</b> <a href="globalIndexAndTransform_8H_source.html#l00060">globalIndexAndTransform.H:60</a></div></div>
<div class="ttc" id="classFoam_1_1UPstream_html_a6ba6de79b96f3b7f2d987b2b657f47e1"><div class="ttname"><a href="classFoam_1_1UPstream.html#a6ba6de79b96f3b7f2d987b2b657f47e1">Foam::UPstream::lastSlave</a></div><div class="ttdeci">static int lastSlave(const label communicator=0)</div><div class="ttdoc">Process index of last slave. </div><div class="ttdef"><b>Definition:</b> <a href="UPstream_8H_source.html#l00591">UPstream.H:591</a></div></div>
<div class="ttc" id="classFoam_1_1Map_html"><div class="ttname"><a href="classFoam_1_1Map.html">Foam::Map</a></div><div class="ttdoc">A HashTable to objects of type &amp;lt;T&amp;gt; with a label key. </div><div class="ttdef"><b>Definition:</b> <a href="HashTableFwd_8H_source.html#l00040">HashTableFwd.H:40</a></div></div>
<div class="ttc" id="classFoam_1_1globalMeshData_html_af4fe16a9cd5d47dc5d68645f7601f6b5"><div class="ttname"><a href="classFoam_1_1globalMeshData.html#af4fe16a9cd5d47dc5d68645f7601f6b5">Foam::globalMeshData::globalEdgeOrientation</a></div><div class="ttdeci">const bitSet &amp; globalEdgeOrientation() const </div><div class="ttdoc">Is my edge same orientation as master edge. </div><div class="ttdef"><b>Definition:</b> <a href="globalMeshData_8C_source.html#l02248">globalMeshData.C:2248</a></div></div>
<div class="ttc" id="namespaceFoam_html_ab64e5584854aaf645dab58faf8793d20"><div class="ttname"><a href="namespaceFoam.html#ab64e5584854aaf645dab58faf8793d20">Foam::Zero</a></div><div class="ttdeci">static constexpr const zero Zero</div><div class="ttdoc">Global zero. </div><div class="ttdef"><b>Definition:</b> <a href="zero_8H_source.html#l00146">zero.H:146</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<hr class="footer"/>
  <address class="footer">
    <small>
      <p>
        Copyright&nbsp;&copy;&nbsp;2011-2018&nbsp;
        <a href="http://www.openfoam.com">OpenFOAM</a>
        |
        OPENFOAM&reg; is a registered
        <a href="http://www.openfoam.com/legal/trademark-policy.php">trademark
        </a> of OpenCFD Ltd.
      </p>
      <p>
        Generated by &#160;<a href="http://www.doxygen.org/index.html">
        <img class="footer" src="doxygen.png" alt="doxygen"/>
        </a> 1.8.5
      </p>
    </small>
  </address>
<!-- BEGIN MATHJAX-->
<!-- END MATHJAX-->
</body>
</html>
